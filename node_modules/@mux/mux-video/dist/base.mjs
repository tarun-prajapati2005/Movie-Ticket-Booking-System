var C=n=>{throw TypeError(n)};var L=(n,a,e)=>a.has(n)||C("Cannot "+e);var s=(n,a,e)=>(L(n,a,"read from private field"),e?e.call(n):a.get(n)),u=(n,a,e)=>a.has(n)?C("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(n):a.set(n,e),o=(n,a,e,i)=>(L(n,a,"write to private field"),i?i.call(n,e):a.set(n,e),e),T=(n,a,e)=>(L(n,a,"access private method"),e);import{initialize as G,teardown as F,generatePlayerInitTime as W,PlaybackTypes as S,toMuxVideoURL as V,MediaError as ce,getError as H,CmcdTypeValues as v,addCuePoints as $,getCuePoints as w,getActiveCuePoint as z,addChapters as X,getActiveChapter as j,getMetadata as q,getStartDate as Z,getCurrentPdt as J,getStreamType as Q,getTargetLiveWindow as ee,getLiveEdgeStart as te,getSeekable as ie,getEnded as re,getChapters as se,toPlaybackIdFromSrc as ne,toPlaybackIdParts as ae}from"@mux/playback-core";var Y=()=>{try{return"0.30.2"}catch{}return"UNKNOWN"},U=Y(),D=()=>U;import{CustomVideoElement as N,Events as be}from"custom-media-element";var k=`
<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" part="logo" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2" viewBox="0 0 1600 500"><g fill="#fff"><path d="M994.287 93.486c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31m0-93.486c-34.509 0-62.484 27.976-62.484 62.486v187.511c0 68.943-56.09 125.033-125.032 125.033s-125.03-56.09-125.03-125.033V62.486C681.741 27.976 653.765 0 619.256 0s-62.484 27.976-62.484 62.486v187.511C556.772 387.85 668.921 500 806.771 500c137.851 0 250.001-112.15 250.001-250.003V62.486c0-34.51-27.976-62.486-62.485-62.486M1537.51 468.511c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31m-275.883-218.509-143.33 143.329c-24.402 24.402-24.402 63.966 0 88.368 24.402 24.402 63.967 24.402 88.369 0l143.33-143.329 143.328 143.329c24.402 24.4 63.967 24.402 88.369 0 24.403-24.402 24.403-63.966.001-88.368l-143.33-143.329.001-.004 143.329-143.329c24.402-24.402 24.402-63.965 0-88.367s-63.967-24.402-88.369 0L1349.996 161.63 1206.667 18.302c-24.402-24.401-63.967-24.402-88.369 0s-24.402 63.965 0 88.367l143.329 143.329v.004ZM437.511 468.521c-17.121 0-31-13.879-31-31 0-17.121 13.879-31 31-31 17.121 0 31 13.879 31 31 0 17.121-13.879 31-31 31M461.426 4.759C438.078-4.913 411.2.432 393.33 18.303L249.999 161.632 106.669 18.303C88.798.432 61.922-4.913 38.573 4.759 15.224 14.43-.001 37.214-.001 62.488v375.026c0 34.51 27.977 62.486 62.487 62.486 34.51 0 62.486-27.976 62.486-62.486V213.341l80.843 80.844c24.404 24.402 63.965 24.402 88.369 0l80.843-80.844v224.173c0 34.51 27.976 62.486 62.486 62.486s62.486-27.976 62.486-62.486V62.488c0-25.274-15.224-48.058-38.573-57.729" style="fill-rule:nonzero"/></g></svg>`;var t={BEACON_COLLECTION_DOMAIN:"beacon-collection-domain",CUSTOM_DOMAIN:"custom-domain",DEBUG:"debug",DISABLE_TRACKING:"disable-tracking",DISABLE_COOKIES:"disable-cookies",DISABLE_PSEUDO_ENDED:"disable-pseudo-ended",DRM_TOKEN:"drm-token",PLAYBACK_TOKEN:"playback-token",ENV_KEY:"env-key",MAX_RESOLUTION:"max-resolution",MIN_RESOLUTION:"min-resolution",MAX_AUTO_RESOLUTION:"max-auto-resolution",RENDITION_ORDER:"rendition-order",PROGRAM_START_TIME:"program-start-time",PROGRAM_END_TIME:"program-end-time",ASSET_START_TIME:"asset-start-time",ASSET_END_TIME:"asset-end-time",METADATA_URL:"metadata-url",PLAYBACK_ID:"playback-id",PLAYER_SOFTWARE_NAME:"player-software-name",PLAYER_SOFTWARE_VERSION:"player-software-version",PLAYER_INIT_TIME:"player-init-time",PREFER_CMCD:"prefer-cmcd",PREFER_PLAYBACK:"prefer-playback",START_TIME:"start-time",STREAM_TYPE:"stream-type",TARGET_LIVE_WINDOW:"target-live-window",LIVE_EDGE_OFFSET:"live-edge-offset",TYPE:"type",LOGO:"logo",CAP_RENDITION_TO_PLAYER_SIZE:"cap-rendition-to-player-size"},oe=Object.values(t),x=D(),K="mux-video",E,c,_,g,p,O,R,I,M,m,y,f,b,B=class extends N{constructor(){super();u(this,f);u(this,E);u(this,c);u(this,_);u(this,g,{});u(this,p,{});u(this,O);u(this,R);u(this,I);u(this,M);u(this,m,"");u(this,y);o(this,_,W()),this.nativeEl.addEventListener("muxmetadata",e=>{var l;let i=q(this.nativeEl),r=(l=this.metadata)!=null?l:{};this.metadata={...i,...r},(i==null?void 0:i["com.mux.video.branding"])==="mux-free-plan"&&(o(this,m,"default"),this.updateLogo())})}static get NAME(){return K}static get VERSION(){return x}static get observedAttributes(){var e;return[...oe,...(e=N.observedAttributes)!=null?e:[]]}static getLogoHTML(e){return!e||e==="false"?"":e==="default"?k:`<img part="logo" src="${e}" />`}static getTemplateHTML(e={}){var i;return`
      ${N.getTemplateHTML(e)}
      <style>
        :host {
          position: relative;
        }
        slot[name="logo"] {
          display: flex;
          justify-content: end;
          position: absolute;
          top: 1rem;
          right: 1rem;
          opacity: 0;
          transition: opacity 0.25s ease-in-out;
          z-index: 1;
        }
        slot[name="logo"]:has([part="logo"]) {
          opacity: 1;
        }
        slot[name="logo"] [part="logo"] {
          width: 5rem;
          pointer-events: none;
          user-select: none;
        }
      </style>
      <slot name="logo">
        ${this.getLogoHTML((i=e[t.LOGO])!=null?i:"")}
      </slot>
    `}get preferCmcd(){var e;return(e=this.getAttribute(t.PREFER_CMCD))!=null?e:void 0}set preferCmcd(e){e!==this.preferCmcd&&(e?v.includes(e)?this.setAttribute(t.PREFER_CMCD,e):console.warn(`Invalid value for preferCmcd. Must be one of ${v.join()}`):this.removeAttribute(t.PREFER_CMCD))}get playerInitTime(){return this.hasAttribute(t.PLAYER_INIT_TIME)?+this.getAttribute(t.PLAYER_INIT_TIME):s(this,_)}set playerInitTime(e){e!=this.playerInitTime&&(e==null?this.removeAttribute(t.PLAYER_INIT_TIME):this.setAttribute(t.PLAYER_INIT_TIME,`${+e}`))}get playerSoftwareName(){var e;return(e=s(this,I))!=null?e:K}set playerSoftwareName(e){o(this,I,e)}get playerSoftwareVersion(){var e;return(e=s(this,R))!=null?e:x}set playerSoftwareVersion(e){o(this,R,e)}get _hls(){var e;return(e=s(this,E))==null?void 0:e.engine}get mux(){var e;return(e=this.nativeEl)==null?void 0:e.mux}get error(){var e;return(e=H(this.nativeEl))!=null?e:null}get errorTranslator(){return s(this,M)}set errorTranslator(e){o(this,M,e)}get src(){return this.getAttribute("src")}set src(e){e!==this.src&&(e==null?this.removeAttribute("src"):this.setAttribute("src",e))}get type(){var e;return(e=this.getAttribute(t.TYPE))!=null?e:void 0}set type(e){e!==this.type&&(e?this.setAttribute(t.TYPE,e):this.removeAttribute(t.TYPE))}get preload(){let e=this.getAttribute("preload");return e===""?"auto":["none","metadata","auto"].includes(e)?e:super.preload}set preload(e){e!=this.getAttribute("preload")&&(["","none","metadata","auto"].includes(e)?this.setAttribute("preload",e):this.removeAttribute("preload"))}get debug(){return this.getAttribute(t.DEBUG)!=null}set debug(e){e!==this.debug&&(e?this.setAttribute(t.DEBUG,""):this.removeAttribute(t.DEBUG))}get disableTracking(){return this.hasAttribute(t.DISABLE_TRACKING)}set disableTracking(e){e!==this.disableTracking&&this.toggleAttribute(t.DISABLE_TRACKING,!!e)}get disableCookies(){return this.hasAttribute(t.DISABLE_COOKIES)}set disableCookies(e){e!==this.disableCookies&&(e?this.setAttribute(t.DISABLE_COOKIES,""):this.removeAttribute(t.DISABLE_COOKIES))}get disablePseudoEnded(){return this.hasAttribute(t.DISABLE_PSEUDO_ENDED)}set disablePseudoEnded(e){e!==this.disablePseudoEnded&&(e?this.setAttribute(t.DISABLE_PSEUDO_ENDED,""):this.removeAttribute(t.DISABLE_PSEUDO_ENDED))}get startTime(){let e=this.getAttribute(t.START_TIME);if(e==null)return;let i=+e;return Number.isNaN(i)?void 0:i}set startTime(e){e!==this.startTime&&(e==null?this.removeAttribute(t.START_TIME):this.setAttribute(t.START_TIME,`${e}`))}get playbackId(){var e;return this.hasAttribute(t.PLAYBACK_ID)?this.getAttribute(t.PLAYBACK_ID):(e=ne(this.src))!=null?e:void 0}set playbackId(e){e!==this.playbackId&&(e?this.setAttribute(t.PLAYBACK_ID,e):this.removeAttribute(t.PLAYBACK_ID))}get maxResolution(){var e;return(e=this.getAttribute(t.MAX_RESOLUTION))!=null?e:void 0}set maxResolution(e){e!==this.maxResolution&&(e?this.setAttribute(t.MAX_RESOLUTION,e):this.removeAttribute(t.MAX_RESOLUTION))}get minResolution(){var e;return(e=this.getAttribute(t.MIN_RESOLUTION))!=null?e:void 0}set minResolution(e){e!==this.minResolution&&(e?this.setAttribute(t.MIN_RESOLUTION,e):this.removeAttribute(t.MIN_RESOLUTION))}get maxAutoResolution(){var e;return(e=this.getAttribute(t.MAX_AUTO_RESOLUTION))!=null?e:void 0}set maxAutoResolution(e){e==null?this.removeAttribute(t.MAX_AUTO_RESOLUTION):this.setAttribute(t.MAX_AUTO_RESOLUTION,e)}get renditionOrder(){var e;return(e=this.getAttribute(t.RENDITION_ORDER))!=null?e:void 0}set renditionOrder(e){e!==this.renditionOrder&&(e?this.setAttribute(t.RENDITION_ORDER,e):this.removeAttribute(t.RENDITION_ORDER))}get programStartTime(){let e=this.getAttribute(t.PROGRAM_START_TIME);if(e==null)return;let i=+e;return Number.isNaN(i)?void 0:i}set programStartTime(e){e==null?this.removeAttribute(t.PROGRAM_START_TIME):this.setAttribute(t.PROGRAM_START_TIME,`${e}`)}get programEndTime(){let e=this.getAttribute(t.PROGRAM_END_TIME);if(e==null)return;let i=+e;return Number.isNaN(i)?void 0:i}set programEndTime(e){e==null?this.removeAttribute(t.PROGRAM_END_TIME):this.setAttribute(t.PROGRAM_END_TIME,`${e}`)}get assetStartTime(){let e=this.getAttribute(t.ASSET_START_TIME);if(e==null)return;let i=+e;return Number.isNaN(i)?void 0:i}set assetStartTime(e){e==null?this.removeAttribute(t.ASSET_START_TIME):this.setAttribute(t.ASSET_START_TIME,`${e}`)}get assetEndTime(){let e=this.getAttribute(t.ASSET_END_TIME);if(e==null)return;let i=+e;return Number.isNaN(i)?void 0:i}set assetEndTime(e){e==null?this.removeAttribute(t.ASSET_END_TIME):this.setAttribute(t.ASSET_END_TIME,`${e}`)}get customDomain(){var e;return(e=this.getAttribute(t.CUSTOM_DOMAIN))!=null?e:void 0}set customDomain(e){e!==this.customDomain&&(e?this.setAttribute(t.CUSTOM_DOMAIN,e):this.removeAttribute(t.CUSTOM_DOMAIN))}get capRenditionToPlayerSize(){var e;return((e=this._hlsConfig)==null?void 0:e.capLevelToPlayerSize)!=null?this._hlsConfig.capLevelToPlayerSize:s(this,y)}set capRenditionToPlayerSize(e){o(this,y,e)}get drmToken(){var e;return(e=this.getAttribute(t.DRM_TOKEN))!=null?e:void 0}set drmToken(e){e!==this.drmToken&&(e?this.setAttribute(t.DRM_TOKEN,e):this.removeAttribute(t.DRM_TOKEN))}get playbackToken(){var e,i,r,l;if(this.hasAttribute(t.PLAYBACK_TOKEN))return(e=this.getAttribute(t.PLAYBACK_TOKEN))!=null?e:void 0;if(this.hasAttribute(t.PLAYBACK_ID)){let[,A]=ae((i=this.playbackId)!=null?i:"");return(r=new URLSearchParams(A).get("token"))!=null?r:void 0}if(this.src)return(l=new URLSearchParams(this.src).get("token"))!=null?l:void 0}set playbackToken(e){e!==this.playbackToken&&(e?this.setAttribute(t.PLAYBACK_TOKEN,e):this.removeAttribute(t.PLAYBACK_TOKEN))}get tokens(){let e=this.getAttribute(t.PLAYBACK_TOKEN),i=this.getAttribute(t.DRM_TOKEN);return{...s(this,p),...e!=null?{playback:e}:{},...i!=null?{drm:i}:{}}}set tokens(e){o(this,p,e!=null?e:{})}get ended(){return re(this.nativeEl,this._hls)}get envKey(){var e;return(e=this.getAttribute(t.ENV_KEY))!=null?e:void 0}set envKey(e){e!==this.envKey&&(e?this.setAttribute(t.ENV_KEY,e):this.removeAttribute(t.ENV_KEY))}get beaconCollectionDomain(){var e;return(e=this.getAttribute(t.BEACON_COLLECTION_DOMAIN))!=null?e:void 0}set beaconCollectionDomain(e){e!==this.beaconCollectionDomain&&(e?this.setAttribute(t.BEACON_COLLECTION_DOMAIN,e):this.removeAttribute(t.BEACON_COLLECTION_DOMAIN))}get streamType(){var e;return(e=this.getAttribute(t.STREAM_TYPE))!=null?e:Q(this.nativeEl)}set streamType(e){e!==this.streamType&&(e?this.setAttribute(t.STREAM_TYPE,e):this.removeAttribute(t.STREAM_TYPE))}get targetLiveWindow(){return this.hasAttribute(t.TARGET_LIVE_WINDOW)?+this.getAttribute(t.TARGET_LIVE_WINDOW):ee(this.nativeEl)}set targetLiveWindow(e){e!=this.targetLiveWindow&&(e==null?this.removeAttribute(t.TARGET_LIVE_WINDOW):this.setAttribute(t.TARGET_LIVE_WINDOW,`${+e}`))}get liveEdgeStart(){var e,i;if(this.hasAttribute(t.LIVE_EDGE_OFFSET)){let{liveEdgeOffset:r}=this,l=(e=this.nativeEl.seekable.end(0))!=null?e:0,A=(i=this.nativeEl.seekable.start(0))!=null?i:0;return Math.max(A,l-r)}return te(this.nativeEl)}get liveEdgeOffset(){if(this.hasAttribute(t.LIVE_EDGE_OFFSET))return+this.getAttribute(t.LIVE_EDGE_OFFSET)}set liveEdgeOffset(e){e!=this.liveEdgeOffset&&(e==null?this.removeAttribute(t.LIVE_EDGE_OFFSET):this.setAttribute(t.LIVE_EDGE_OFFSET,`${+e}`))}get seekable(){return ie(this.nativeEl)}async addCuePoints(e){return $(this.nativeEl,e)}get activeCuePoint(){return z(this.nativeEl)}get cuePoints(){return w(this.nativeEl)}async addChapters(e){return X(this.nativeEl,e)}get activeChapter(){return j(this.nativeEl)}get chapters(){return se(this.nativeEl)}getStartDate(){return Z(this.nativeEl,this._hls)}get currentPdt(){return J(this.nativeEl,this._hls)}get preferPlayback(){let e=this.getAttribute(t.PREFER_PLAYBACK);if(e===S.MSE||e===S.NATIVE)return e}set preferPlayback(e){e!==this.preferPlayback&&(e===S.MSE||e===S.NATIVE?this.setAttribute(t.PREFER_PLAYBACK,e):this.removeAttribute(t.PREFER_PLAYBACK))}get metadata(){return{...this.getAttributeNames().filter(i=>i.startsWith("metadata-")&&![t.METADATA_URL].includes(i)).reduce((i,r)=>{let l=this.getAttribute(r);return l!=null&&(i[r.replace(/^metadata-/,"").replace(/-/g,"_")]=l),i},{}),...s(this,g)}}set metadata(e){o(this,g,e!=null?e:{}),this.mux&&this.mux.emit("hb",s(this,g))}get _hlsConfig(){return s(this,O)}set _hlsConfig(e){o(this,O,e)}get logo(){var e;return(e=this.getAttribute(t.LOGO))!=null?e:s(this,m)}set logo(e){e?this.setAttribute(t.LOGO,e):this.removeAttribute(t.LOGO)}load(){o(this,E,G(this,this.nativeEl,s(this,E)))}unload(){F(this.nativeEl,s(this,E),this),o(this,E,void 0)}attributeChangedCallback(e,i,r){var A,P;switch(N.observedAttributes.includes(e)&&!["src","autoplay","preload"].includes(e)&&super.attributeChangedCallback(e,i,r),e){case t.PLAYER_SOFTWARE_NAME:this.playerSoftwareName=r!=null?r:void 0;break;case t.PLAYER_SOFTWARE_VERSION:this.playerSoftwareVersion=r!=null?r:void 0;break;case"src":{let d=!!i,h=!!r;!d&&h?T(this,f,b).call(this):d&&!h?this.unload():d&&h&&(this.unload(),T(this,f,b).call(this));break}case"autoplay":if(r===i)break;(A=s(this,E))==null||A.setAutoplay(this.autoplay);break;case"preload":if(r===i)break;(P=s(this,E))==null||P.setPreload(r);break;case t.PLAYBACK_ID:this.src=V(this);break;case t.DEBUG:{let d=this.debug;this.mux&&console.info("Cannot toggle debug mode of mux data after initialization. Make sure you set all metadata to override before setting the src."),this._hls&&(this._hls.config.debug=d);break}case t.METADATA_URL:r&&fetch(r).then(d=>d.json()).then(d=>this.metadata=d).catch(()=>console.error(`Unable to load or parse metadata JSON from metadata-url ${r}!`));break;case t.STREAM_TYPE:(r==null||r!==i)&&this.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}));break;case t.TARGET_LIVE_WINDOW:(r==null||r!==i)&&this.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0,detail:this.targetLiveWindow}));break;case t.LOGO:(r==null||r!==i)&&this.updateLogo();break;case t.DISABLE_TRACKING:{if(r==null||r!==i){let d=this.currentTime,h=this.paused;this.unload(),T(this,f,b).call(this).then(()=>{this.currentTime=d,h||this.play()})}break}case t.DISABLE_COOKIES:{(r==null||r!==i)&&this.disableCookies&&document.cookie.split(";").forEach(h=>{h.trim().startsWith("muxData")&&(document.cookie=h.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/"))});break}case t.CAP_RENDITION_TO_PLAYER_SIZE:(r==null||r!==i)&&(this.capRenditionToPlayerSize=r!=null?!0:void 0)}}updateLogo(){if(!this.shadowRoot)return;let e=this.shadowRoot.querySelector('slot[name="logo"]');if(!e)return;let i=this.constructor.getLogoHTML(s(this,m)||this.logo);e.innerHTML=i}connectedCallback(){var e;(e=super.connectedCallback)==null||e.call(this),this.nativeEl&&this.src&&!s(this,E)&&T(this,f,b).call(this)}disconnectedCallback(){this.unload()}handleEvent(e){e.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(e.type,{composed:!0,detail:e.detail}))}};E=new WeakMap,c=new WeakMap,_=new WeakMap,g=new WeakMap,p=new WeakMap,O=new WeakMap,R=new WeakMap,I=new WeakMap,M=new WeakMap,m=new WeakMap,y=new WeakMap,f=new WeakSet,b=async function(){s(this,c)||(await o(this,c,Promise.resolve()),o(this,c,null),this.load())};export{t as Attributes,be as Events,ce as MediaError,B as MuxVideoBaseElement,W as generatePlayerInitTime,K as playerSoftwareName,x as playerSoftwareVersion};
//# sourceMappingURL=base.mjs.map
