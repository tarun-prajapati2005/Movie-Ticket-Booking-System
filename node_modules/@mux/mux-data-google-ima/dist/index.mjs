function _t(i){if(Array.isArray(i))return i}function pt(i,e){var t=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var a=[],r=!0,n=!1,o,u;try{for(t=t.call(i);!(r=(o=t.next()).done)&&(a.push(o.value),!(e&&a.length===e));r=!0);}catch(s){n=!0,u=s}finally{try{!r&&t.return!=null&&t.return()}finally{if(n)throw u}}return a}}function vt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function we(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=i[t];return a}function Me(i,e){if(i){if(typeof i=="string")return we(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return we(i,e)}}function le(i,e){return _t(i)||pt(i,e)||Me(i,e)||vt()}function ht(i){if(Array.isArray(i))return we(i)}function ft(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function mt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ke(i){return ht(i)||ft(i)||Me(i)||mt()}var fa=Object.create,At=Object.defineProperty,ma=Object.getOwnPropertyDescriptor,ya=Object.getOwnPropertyNames,ga=Object.getPrototypeOf,ba=Object.prototype.hasOwnProperty,xt=function(e,t){return function(){return e&&(t=e(e=0)),t}},V=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},Ea=function(e,t,a,r){if(t&&typeof t=="object"||typeof t=="function")for(var n=ya(t),o=0,u=n.length,s;o<u;o++)s=n[o],!ba.call(e,s)&&s!==a&&At(e,s,{get:function(d){return t[d]}.bind(null,s),enumerable:!(r=ma(t,s))||r.enumerable});return e},K=function(e,t,a){return a=e!=null?fa(ga(e)):{},Ea(t||!e||!e.__esModule?At(a,"default",{value:e,enumerable:!0}):a,e)},ae=V(function(i,e){var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t={},e.exports=t});function ve(i,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](i):ve(i,e)}var he=xt(function(){he()});function St(i){"@swc/helpers - typeof";return i&&typeof Symbol!="undefined"&&i.constructor===Symbol?"symbol":typeof i}var Rt=xt(function(){}),Ot=V(function(i,e){var t=Array.prototype.slice;e.exports=a;function a(r,n){for(("length"in r)||(r=[r]),r=t.call(r);r.length;){var o=r.shift(),u=n(o);if(u)return u;o.childNodes&&o.childNodes.length&&(r=t.call(o.childNodes).concat(r))}}}),Ta=V(function(i,e){he(),e.exports=t;function t(a,r){if(!ve(this,t))return new t(a,r);this.data=a,this.nodeValue=a,this.length=a.length,this.ownerDocument=r||null}t.prototype.nodeType=8,t.prototype.nodeName="#comment",t.prototype.toString=function(){return"[object Comment]"}}),wa=V(function(i,e){he(),e.exports=t;function t(a,r){if(!ve(this,t))return new t(a);this.data=a||"",this.length=this.data.length,this.ownerDocument=r||null}t.prototype.type="DOMTextNode",t.prototype.nodeType=3,t.prototype.nodeName="#text",t.prototype.toString=function(){return this.data},t.prototype.replaceData=function(a,r,n){var o=this.data,u=o.substring(0,a),s=o.substring(a+r,o.length);this.data=u+n+s,this.length=this.data.length}}),Pt=V(function(i,e){e.exports=t;function t(a){var r=this,n=a.type;a.target||(a.target=r),r.listeners||(r.listeners={});var o=r.listeners[n];if(o)return o.forEach(function(u){a.currentTarget=r,typeof u=="function"?u(a):u.handleEvent(a)});r.parentNode&&r.parentNode.dispatchEvent(a)}}),Lt=V(function(i,e){e.exports=t;function t(a,r){var n=this;n.listeners||(n.listeners={}),n.listeners[a]||(n.listeners[a]=[]),n.listeners[a].indexOf(r)===-1&&n.listeners[a].push(r)}}),qt=V(function(i,e){e.exports=t;function t(a,r){var n=this;if(n.listeners&&n.listeners[a]){var o=n.listeners[a],u=o.indexOf(r);u!==-1&&o.splice(u,1)}}}),ka=V(function(i,e){Rt(),e.exports=a;var t=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function a(c){switch(c.nodeType){case 3:return _(c.data);case 8:return"<!--"+c.data+"-->";default:return r(c)}}function r(c){var l=[],p=c.tagName;return c.namespaceURI==="http://www.w3.org/1999/xhtml"&&(p=p.toLowerCase()),l.push("<"+p+d(c)+u(c)),t.indexOf(p)>-1?l.push(" />"):(l.push(">"),c.childNodes.length?l.push.apply(l,c.childNodes.map(a)):c.textContent||c.innerText?l.push(_(c.textContent||c.innerText)):c.innerHTML&&l.push(c.innerHTML),l.push("</"+p+">")),l.join("")}function n(c,l){var p=St(c[l]);return l==="style"&&Object.keys(c.style).length>0?!0:c.hasOwnProperty(l)&&(p==="string"||p==="boolean"||p==="number")&&l!=="nodeName"&&l!=="className"&&l!=="tagName"&&l!=="textContent"&&l!=="innerText"&&l!=="namespaceURI"&&l!=="innerHTML"}function o(c){if(typeof c=="string")return c;var l="";return Object.keys(c).forEach(function(p){var h=c[p];p=p.replace(/[A-Z]/g,function(D){return"-"+D.toLowerCase()}),l+=p+":"+h+";"}),l}function u(c){var l=c.dataset,p=[];for(var h in l)p.push({name:"data-"+h,value:l[h]});return p.length?s(p):""}function s(c){var l=[];return c.forEach(function(p){var h=p.name,D=p.value;h==="style"&&(D=o(D)),l.push(h+'="'+y(D)+'"')}),l.length?" "+l.join(" "):""}function d(c){var l=[];for(var p in c)n(c,p)&&l.push({name:p,value:c[p]});for(var h in c._attributes)for(var D in c._attributes[h]){var x=c._attributes[h][D],E=(x.prefix?x.prefix+":":"")+D;l.push({name:E,value:x.value})}return c.className&&l.push({name:"class",value:c.className}),l.length?s(l):""}function _(c){var l="";return typeof c=="string"?l=c:c&&(l=c.toString()),l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function y(c){return _(c).replace(/"/g,"&quot;")}}),It=V(function(i,e){he();var t=Ot(),a=Pt(),r=Lt(),n=qt(),o=ka(),u="http://www.w3.org/1999/xhtml";e.exports=s;function s(d,_,y){if(!ve(this,s))return new s(d);var c=y===void 0?u:y||null;this.tagName=c===u?String(d).toUpperCase():d,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=_||null,this.namespaceURI=c,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}s.prototype.type="DOMElement",s.prototype.nodeType=1,s.prototype.appendChild=function(d){return d.parentNode&&d.parentNode.removeChild(d),this.childNodes.push(d),d.parentNode=this,d},s.prototype.replaceChild=function(d,_){d.parentNode&&d.parentNode.removeChild(d);var y=this.childNodes.indexOf(_);return _.parentNode=null,this.childNodes[y]=d,d.parentNode=this,_},s.prototype.removeChild=function(d){var _=this.childNodes.indexOf(d);return this.childNodes.splice(_,1),d.parentNode=null,d},s.prototype.insertBefore=function(d,_){d.parentNode&&d.parentNode.removeChild(d);var y=_==null?-1:this.childNodes.indexOf(_);return y>-1?this.childNodes.splice(y,0,d):this.childNodes.push(d),d.parentNode=this,d},s.prototype.setAttributeNS=function(d,_,y){var c=null,l=_,p=_.indexOf(":");if(p>-1&&(c=_.substr(0,p),l=_.substr(p+1)),this.tagName==="INPUT"&&_==="type")this.type=y;else{var h=this._attributes[d]||(this._attributes[d]={});h[l]={value:y,prefix:c}}},s.prototype.getAttributeNS=function(d,_){var y=this._attributes[d],c=y&&y[_]&&y[_].value;return this.tagName==="INPUT"&&_==="type"?this.type:typeof c!="string"?null:c},s.prototype.removeAttributeNS=function(d,_){var y=this._attributes[d];y&&delete y[_]},s.prototype.hasAttributeNS=function(d,_){var y=this._attributes[d];return!!y&&_ in y},s.prototype.setAttribute=function(d,_){return this.setAttributeNS(null,d,_)},s.prototype.getAttribute=function(d){return this.getAttributeNS(null,d)},s.prototype.removeAttribute=function(d){return this.removeAttributeNS(null,d)},s.prototype.hasAttribute=function(d){return this.hasAttributeNS(null,d)},s.prototype.removeEventListener=n,s.prototype.addEventListener=r,s.prototype.dispatchEvent=a,s.prototype.focus=function(){},s.prototype.toString=function(){return o(this)},s.prototype.getElementsByClassName=function(d){var _=d.split(" "),y=[];return t(this,function(c){if(c.nodeType===1){var l=c.className||"",p=l.split(" ");_.every(function(h){return p.indexOf(h)!==-1})&&y.push(c)}}),y},s.prototype.getElementsByTagName=function(d){d=d.toLowerCase();var _=[];return t(this.childNodes,function(y){y.nodeType===1&&(d==="*"||y.tagName.toLowerCase()===d)&&_.push(y)}),_},s.prototype.contains=function(d){return t(this,function(_){return d===_})||!1}}),Da=V(function(i,e){he();var t=It();e.exports=a;function a(r){if(!ve(this,a))return new a;this.childNodes=[],this.parentNode=null,this.ownerDocument=r||null}a.prototype.type="DocumentFragment",a.prototype.nodeType=11,a.prototype.nodeName="#document-fragment",a.prototype.appendChild=t.prototype.appendChild,a.prototype.replaceChild=t.prototype.replaceChild,a.prototype.removeChild=t.prototype.removeChild,a.prototype.toString=function(){return this.childNodes.map(function(r){return String(r)}).join("")}}),Aa=V(function(i,e){e.exports=t;function t(a){}t.prototype.initEvent=function(a,r,n){this.type=a,this.bubbles=r,this.cancelable=n},t.prototype.preventDefault=function(){}}),xa=V(function(i,e){he();var t=Ot(),a=Ta(),r=wa(),n=It(),o=Da(),u=Aa(),s=Pt(),d=Lt(),_=qt();e.exports=y;function y(){if(!ve(this,y))return new y;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var c=y.prototype;c.createTextNode=function(l){return new r(l,this)},c.createElementNS=function(l,p){var h=l===null?null:String(l);return new n(p,this,h)},c.createElement=function(l){return new n(l,this)},c.createDocumentFragment=function(){return new o(this)},c.createEvent=function(l){return new u(l)},c.createComment=function(l){return new a(l,this)},c.getElementById=function(l){l=String(l);var p=t(this.childNodes,function(h){if(String(h.id)===l)return h});return p||null},c.getElementsByClassName=n.prototype.getElementsByClassName,c.getElementsByTagName=n.prototype.getElementsByTagName,c.contains=n.prototype.contains,c.removeEventListener=_,c.addEventListener=d,c.dispatchEvent=s}),Sa=V(function(i,e){var t=xa();e.exports=new t}),Nt=V(function(i,e){var t=typeof global!="undefined"?global:typeof window!="undefined"?window:{},a=Sa(),r;typeof document!="undefined"?r=document:(r=t["__GLOBAL_DOCUMENT_CACHE@4"],r||(r=t["__GLOBAL_DOCUMENT_CACHE@4"]=a)),e.exports=r});function Ra(i){if(Array.isArray(i))return i}function Oa(i,e){var t=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var a=[],r=!0,n=!1,o,u;try{for(t=t.call(i);!(r=(o=t.next()).done)&&(a.push(o.value),!(e&&a.length===e));r=!0);}catch(s){n=!0,u=s}finally{try{!r&&t.return!=null&&t.return()}finally{if(n)throw u}}return a}}function Pa(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rt(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=i[t];return a}function Ct(i,e){if(i){if(typeof i=="string")return rt(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return rt(i,e)}}function re(i,e){return Ra(i)||Oa(i,e)||Ct(i,e)||Pa()}var xe=K(ae()),yt=K(ae()),La=K(ae()),qa={now:function(){var e=La.default.performance,t=e&&e.timing,a=t&&t.navigationStart,r=typeof a=="number"&&typeof e.now=="function"?a+e.now():Date.now();return Math.round(r)}},F=qa,Re=function(){var e,t,a;if(typeof((e=yt.default.crypto)===null||e===void 0?void 0:e.getRandomValues)=="function"){a=new Uint8Array(32),yt.default.crypto.getRandomValues(a);for(var r=0;r<32;r++)a[r]=a[r]%16}else{a=[];for(var n=0;n<32;n++)a[n]=Math.random()*16|0}var o=0;t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var _=d==="x"?a[o]:a[o]&3|8;return o++,_.toString(16)});var u=F.now(),s=u==null?void 0:u.toString(16).substring(3);return s?t.substring(0,28)+s:t},jt=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},X=function(e){if(e&&typeof e.nodeName!="undefined")return e.muxId||(e.muxId=jt()),e.muxId;var t;try{t=document.querySelector(e)}catch(a){}return t&&!t.muxId&&(t.muxId=e),(t==null?void 0:t.muxId)||e},Be=function(e){var t;e&&typeof e.nodeName!="undefined"?(t=e,e=X(t)):t=document.querySelector(e);var a=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,a]};function Ia(i){if(Array.isArray(i))return rt(i)}function Na(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Ca(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Z(i){return Ia(i)||Na(i)||Ct(i)||Ca()}var _e={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},ja=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,a,r,n,o,u,s=e?[console,e]:[console],d=(a=console.trace).bind.apply(a,Z(s)),_=(r=console.info).bind.apply(r,Z(s)),y=(n=console.debug).bind.apply(n,Z(s)),c=(o=console.warn).bind.apply(o,Z(s)),l=(u=console.error).bind.apply(u,Z(s)),p=t;return{trace:function(){for(var D=arguments.length,x=new Array(D),E=0;E<D;E++)x[E]=arguments[E];if(!(p>_e.TRACE))return d.apply(void 0,Z(x))},debug:function(){for(var D=arguments.length,x=new Array(D),E=0;E<D;E++)x[E]=arguments[E];if(!(p>_e.DEBUG))return y.apply(void 0,Z(x))},info:function(){for(var D=arguments.length,x=new Array(D),E=0;E<D;E++)x[E]=arguments[E];if(!(p>_e.INFO))return _.apply(void 0,Z(x))},warn:function(){for(var D=arguments.length,x=new Array(D),E=0;E<D;E++)x[E]=arguments[E];if(!(p>_e.WARN))return c.apply(void 0,Z(x))},error:function(){for(var D=arguments.length,x=new Array(D),E=0;E<D;E++)x[E]=arguments[E];if(!(p>_e.ERROR))return l.apply(void 0,Z(x))},get level(){return p},set level(h){h!==this.level&&(p=h!=null?h:t)}}},N=ja("[mux]"),Xe=K(ae());function it(){var i=Xe.default.doNotTrack||Xe.default.navigator&&Xe.default.navigator.doNotTrack;return i==="1"}function k(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}he();function U(i,e){if(!ve(i,e))throw new TypeError("Cannot call a class as a function")}function gt(i,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function ee(i,e,t){return e&&gt(i.prototype,e),t&&gt(i,t),i}function f(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function be(i){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},be(i)}function Ma(i,e){for(;!Object.prototype.hasOwnProperty.call(i,e)&&(i=be(i),i!==null););return i}function Ue(i,e,t){return typeof Reflect!="undefined"&&Reflect.get?Ue=Reflect.get:Ue=function(r,n,o){var u=Ma(r,n);if(u){var s=Object.getOwnPropertyDescriptor(u,n);return s.get?s.get.call(o||r):s.value}},Ue(i,e,t||i)}function nt(i,e){return nt=Object.setPrototypeOf||function(t,a){return t.__proto__=a,t},nt(i,e)}function Ha(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&nt(i,e)}function Ua(i,e){if(i==null)return{};var t={},a=Object.keys(i),r,n;for(n=0;n<a.length;n++)r=a[n],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function Ba(i,e){if(i==null)return{};var t=Ua(i,e),a,r;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);for(r=0;r<n.length;r++)a=n[r],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(i,a)&&(t[a]=i[a])}return t}function Fa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(i){return!1}}Rt();function Ja(i,e){return e&&(St(e)==="object"||typeof e=="function")?e:k(i)}function Ga(i){var e=Fa();return function(){var t=be(i),a;if(e){var r=be(this).constructor;a=Reflect.construct(t,arguments,r)}else a=t.apply(this,arguments);return Ja(this,a)}}var $=function(e){return Oe(e)[0]},Oe=function(e){if(typeof e!="string"||e==="")return["localhost"];var t=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,a=e.match(t)||[],r=a[4],n;return r&&(n=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,n]},Ze=K(ae()),Qa={exists:function(){var e=Ze.default.performance,t=e&&e.timing;return t!==void 0},domContentLoadedEventEnd:function(){var e=Ze.default.performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},navigationStart:function(){var e=Ze.default.performance,t=e&&e.timing;return t&&t.navigationStart}},Fe=Qa;function B(i,e,t){t=t===void 0?1:t,i[e]=i[e]||0,i[e]+=t}function Je(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},a=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.forEach(function(r){f(i,r,t[r])})}return i}function Va(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);e&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,a)}return t}function st(i,e){return e=e!=null?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Va(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}),i}var Wa=["x-cdn","content-type"],Mt=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],za=Wa.concat(Mt);function ut(i){i=i||"";var e={},t=i.trim().split(/[\r\n]+/);return t.forEach(function(a){if(a){var r=a.split(": "),n=r.shift();n&&(za.indexOf(n.toLowerCase())>=0||n.toLowerCase().indexOf("x-litix-")===0)&&(e[n]=r.join(": "))}}),e}function Ge(i){if(i){var e=Mt.find(function(t){return i[t]!==void 0});return e?i[e]:void 0}}var Ka=function(e){var t={};for(var a in e){var r=e[a],n=r["DATA-ID"].search("io.litix.data.");if(n!==-1){var o=r["DATA-ID"].replace("io.litix.data.","");t[o]=r.VALUE}}return t},Ht=Ka,He=function(e){if(!e)return{};var t=Fe.navigationStart(),a=e.loading,r=a?a.start:e.trequest,n=a?a.first:e.tfirst,o=a?a.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+r),responseStart:Math.round(t+n),responseEnd:Math.round(t+o)}},De=function(e){if(!(!e||typeof e.getAllResponseHeaders!="function"))return ut(e.getAllResponseHeaders())},Ya=function(e,t,a){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=arguments.length>4?arguments[4]:void 0,o=e.log,u=e.utils.secondsToMs,s=function(q){var b=parseInt(n.version),g;return b===1&&q.programDateTime!==null&&(g=q.programDateTime),b===0&&q.pdt!==null&&(g=q.pdt),g};if(!Fe.exists()){o.warn("performance timing not supported. Not tracking HLS.js.");return}var d=function(q,b){return e.emit(t,q,b)},_=function(q,b){var g=b.levels,v=b.audioTracks,w=b.url,T=b.stats,S=b.networkDetails,O=b.sessionData,I={},C={};g.forEach(function(Q,te){I[te]={width:Q.width,height:Q.height,bitrate:Q.bitrate,attrs:Q.attrs}}),v.forEach(function(Q,te){C[te]={name:Q.name,language:Q.lang,bitrate:Q.bitrate}});var L=He(T),R=L.bytesLoaded,Y=L.requestStart,oe=L.responseStart,se=L.responseEnd;d("requestcompleted",st(Je({},Ht(O)),{request_event_type:q,request_bytes_loaded:R,request_start:Y,request_response_start:oe,request_response_end:se,request_type:"manifest",request_hostname:$(w),request_response_headers:De(S),request_rendition_lists:{media:I,audio:C,video:{}}}))};a.on(n.Events.MANIFEST_LOADED,_);var y=function(q,b){var g=b.details,v=b.level,w=b.networkDetails,T=b.stats,S=He(T),O=S.bytesLoaded,I=S.requestStart,C=S.responseStart,L=S.responseEnd,R=g.fragments[g.fragments.length-1],Y=s(R)+u(R.duration);d("requestcompleted",{request_event_type:q,request_bytes_loaded:O,request_start:I,request_response_start:C,request_response_end:L,request_current_level:v,request_type:"manifest",request_hostname:$(g.url),request_response_headers:De(w),video_holdback:g.holdBack&&u(g.holdBack),video_part_holdback:g.partHoldBack&&u(g.partHoldBack),video_part_target_duration:g.partTarget&&u(g.partTarget),video_target_duration:g.targetduration&&u(g.targetduration),video_source_is_live:g.live,player_manifest_newest_program_time:isNaN(Y)?void 0:Y})};a.on(n.Events.LEVEL_LOADED,y);var c=function(q,b){var g=b.details,v=b.networkDetails,w=b.stats,T=He(w),S=T.bytesLoaded,O=T.requestStart,I=T.responseStart,C=T.responseEnd;d("requestcompleted",{request_event_type:q,request_bytes_loaded:S,request_start:O,request_response_start:I,request_response_end:C,request_type:"manifest",request_hostname:$(g.url),request_response_headers:De(v)})};a.on(n.Events.AUDIO_TRACK_LOADED,c);var l=function(q,b){var g=b.stats,v=b.networkDetails,w=b.frag;g=g||w.stats;var T=He(g),S=T.bytesLoaded,O=T.requestStart,I=T.responseStart,C=T.responseEnd,L=v?De(v):void 0,R={request_event_type:q,request_bytes_loaded:S,request_start:O,request_response_start:I,request_response_end:C,request_hostname:v?$(v.responseURL):void 0,request_id:L?Ge(L):void 0,request_response_headers:L,request_media_duration:w.duration,request_url:v==null?void 0:v.responseURL};w.type==="main"?(R.request_type="media",R.request_current_level=w.level,R.request_video_width=(a.levels[w.level]||{}).width,R.request_video_height=(a.levels[w.level]||{}).height,R.request_labeled_bitrate=(a.levels[w.level]||{}).bitrate):R.request_type=w.type,d("requestcompleted",R)};a.on(n.Events.FRAG_LOADED,l);var p=function(q,b){var g=b.frag,v=g.start,w=s(g),T={currentFragmentPDT:w,currentFragmentStart:u(v)};d("fragmentchange",T)};a.on(n.Events.FRAG_CHANGED,p);var h=function(q,b){var g=b.type,v=b.details,w=b.response,T=b.fatal,S=b.frag,O=b.networkDetails,I=(S==null?void 0:S.url)||b.url||"",C=O?De(O):void 0;if((v===n.ErrorDetails.MANIFEST_LOAD_ERROR||v===n.ErrorDetails.MANIFEST_LOAD_TIMEOUT||v===n.ErrorDetails.FRAG_LOAD_ERROR||v===n.ErrorDetails.FRAG_LOAD_TIMEOUT||v===n.ErrorDetails.LEVEL_LOAD_ERROR||v===n.ErrorDetails.LEVEL_LOAD_TIMEOUT||v===n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||v===n.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||v===n.ErrorDetails.SUBTITLE_LOAD_ERROR||v===n.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||v===n.ErrorDetails.KEY_LOAD_ERROR||v===n.ErrorDetails.KEY_LOAD_TIMEOUT)&&d("requestfailed",{request_error:v,request_url:I,request_hostname:$(I),request_id:C?Ge(C):void 0,request_type:v===n.ErrorDetails.FRAG_LOAD_ERROR||v===n.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":v===n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||v===n.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":v===n.ErrorDetails.SUBTITLE_LOAD_ERROR||v===n.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":v===n.ErrorDetails.KEY_LOAD_ERROR||v===n.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:w==null?void 0:w.code,request_error_text:w==null?void 0:w.text}),T){var L,R="".concat(I?"url: ".concat(I,"\n"):"")+"".concat(w&&(w.code||w.text)?"response: ".concat(w.code,", ").concat(w.text,"\n"):"")+"".concat(b.reason?"failure reason: ".concat(b.reason,"\n"):"")+"".concat(b.level?"level: ".concat(b.level,"\n"):"")+"".concat(b.parent?"parent stream controller: ".concat(b.parent,"\n"):"")+"".concat(b.buffer?"buffer length: ".concat(b.buffer,"\n"):"")+"".concat(b.error?"error: ".concat(b.error,"\n"):"")+"".concat(b.event?"event: ".concat(b.event,"\n"):"")+"".concat(b.err?"error message: ".concat((L=b.err)===null||L===void 0?void 0:L.message,"\n"):"");d("error",{player_error_code:g,player_error_message:v,player_error_context:R})}};a.on(n.Events.ERROR,h);var D=function(q,b){var g=b.frag,v=g&&g._url||"";d("requestcanceled",{request_event_type:q,request_url:v,request_type:"media",request_hostname:$(v)})};a.on(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,D);var x=function(q,b){var g=b.level,v=a.levels[g];if(v&&v.attrs&&v.attrs.BANDWIDTH){var w=v.attrs.BANDWIDTH,T,S=parseFloat(v.attrs["FRAME-RATE"]);isNaN(S)||(T=S),w?d("renditionchange",{video_source_fps:T,video_source_bitrate:w,video_source_width:v.width,video_source_height:v.height,video_source_rendition_name:v.name,video_source_codec:v==null?void 0:v.videoCodec}):o.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};a.on(n.Events.LEVEL_SWITCHED,x),a._stopMuxMonitor=function(){a.off(n.Events.MANIFEST_LOADED,_),a.off(n.Events.LEVEL_LOADED,y),a.off(n.Events.AUDIO_TRACK_LOADED,c),a.off(n.Events.FRAG_LOADED,l),a.off(n.Events.FRAG_CHANGED,p),a.off(n.Events.ERROR,h),a.off(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,D),a.off(n.Events.LEVEL_SWITCHED,x),a.off(n.Events.DESTROYING,a._stopMuxMonitor),delete a._stopMuxMonitor},a.on(n.Events.DESTROYING,a._stopMuxMonitor)},Xa=function(e){e&&typeof e._stopMuxMonitor=="function"&&e._stopMuxMonitor()},bt=function(e,t){if(!e||!e.requestEndDate)return{};var a=$(e.url),r=e.url,n=e.bytesLoaded,o=new Date(e.requestStartDate).getTime(),u=new Date(e.firstByteDate).getTime(),s=new Date(e.requestEndDate).getTime(),d=isNaN(e.duration)?0:e.duration,_=typeof t.getMetricsFor=="function"?t.getMetricsFor(e.mediaType).HttpList:t.getDashMetrics().getHttpRequests(e.mediaType),y;_.length>0&&(y=ut(_[_.length-1]._responseHeaders||""));var c=y?Ge(y):void 0;return{requestStart:o,requestResponseStart:u,requestResponseEnd:s,requestBytesLoaded:n,requestResponseHeaders:y,requestMediaDuration:d,requestHostname:a,requestUrl:r,requestId:c}},Za=function(e,t){var a=t.getQualityFor(e),r=t.getCurrentTrackFor(e).bitrateList;return r?{currentLevel:a,renditionWidth:r[a].width||null,renditionHeight:r[a].height||null,renditionBitrate:r[a].bandwidth}:{}},$a=function(e){var t;return(t=e.match(/.*codecs\*?="(.*)"/))===null||t===void 0?void 0:t[1]},er=function(e){try{var t,a,r=(a=e.getVersion)===null||a===void 0||(t=a.call(e))===null||t===void 0?void 0:t.split(".").map(function(n){return parseInt(n)})[0];return r}catch(n){return!1}},tr=function(e,t,a){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=e.log;if(!a||!a.on){n.warn("Invalid dash.js player reference. Monitoring blocked.");return}var o=er(a),u=function(g,v){return e.emit(t,g,v)},s=function(g){var v=g.type,w=g.data,T=(w||{}).url;u("requestcompleted",{request_event_type:v,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:$(T),request_url:T})};a.on("manifestLoaded",s);var d={},_=function(g){if(typeof g.getRequests!="function")return null;var v=g.getRequests({state:"executed"});return v.length===0?null:v[v.length-1]},y=function(g){var v=g.type,w=g.fragmentModel,T=g.chunk,S=_(w);c({type:v,request:S,chunk:T})},c=function(g){var v=g.type,w=g.chunk,T=g.request,S=(w||{}).mediaInfo,O=S||{},I=O.type,C=O.bitrateList;C=C||[];var L={};C.forEach(function(ue,W){L[W]={},L[W].width=ue.width,L[W].height=ue.height,L[W].bitrate=ue.bandwidth,L[W].attrs={}}),I==="video"?d.video=L:I==="audio"?d.audio=L:d.media=L;var R=bt(T,a),Y=R.requestStart,oe=R.requestResponseStart,se=R.requestResponseEnd,Q=R.requestResponseHeaders,te=R.requestMediaDuration,fe=R.requestHostname,me=R.requestUrl,ye=R.requestId;u("requestcompleted",{request_event_type:v,request_start:Y,request_response_start:oe,request_response_end:se,request_bytes_loaded:-1,request_type:I+"_init",request_response_headers:Q,request_hostname:fe,request_id:ye,request_url:me,request_media_duration:te,request_rendition_lists:d})};o>=4?a.on("initFragmentLoaded",c):a.on("initFragmentLoaded",y);var l=function(g){var v=g.type,w=g.fragmentModel,T=g.chunk,S=_(w);p({type:v,request:S,chunk:T})},p=function(g){var v=g.type,w=g.chunk,T=g.request,S=w||{},O=S.mediaInfo,I=S.start,C=O||{},L=C.type,R=bt(T,a),Y=R.requestStart,oe=R.requestResponseStart,se=R.requestResponseEnd,Q=R.requestBytesLoaded,te=R.requestResponseHeaders,fe=R.requestMediaDuration,me=R.requestHostname,ye=R.requestUrl,ue=R.requestId,W=Za(L,a),Pe=W.currentLevel,Le=W.renditionWidth,qe=W.renditionHeight,Ie=W.renditionBitrate;u("requestcompleted",{request_event_type:v,request_start:Y,request_response_start:oe,request_response_end:se,request_bytes_loaded:Q,request_type:L,request_response_headers:te,request_hostname:me,request_id:ue,request_url:ye,request_media_start_time:I,request_media_duration:fe,request_current_level:Pe,request_labeled_bitrate:Ie,request_video_width:Le,request_video_height:qe})};o>=4?a.on("mediaFragmentLoaded",p):a.on("mediaFragmentLoaded",l);var h={video:void 0,audio:void 0,totalBitrate:void 0},D=function(){if(h.video&&typeof h.video.bitrate=="number"){if(!(h.video.width&&h.video.height)){n.warn("have bitrate info for video but missing width/height");return}var g=h.video.bitrate;if(h.audio&&typeof h.audio.bitrate=="number"&&(g+=h.audio.bitrate),g!==h.totalBitrate)return h.totalBitrate=g,{video_source_bitrate:g,video_source_height:h.video.height,video_source_width:h.video.width,video_source_codec:$a(h.video.codec)}}},x=function(g,v,w){if(typeof g.newQuality!="number"){n.warn("missing evt.newQuality in qualityChangeRendered event",g);return}var T=g.mediaType;if(T==="audio"||T==="video"){var S=a.getBitrateInfoListFor(T).find(function(I){var C=I.qualityIndex;return C===g.newQuality});if(!(S&&typeof S.bitrate=="number")){n.warn("missing bitrate info for ".concat(T));return}h[T]=st(Je({},S),{codec:a.getCurrentTrackFor(T).codec});var O=D();O&&u("renditionchange",O)}};a.on("qualityChangeRendered",x);var E=function(g){var v=g.request,w=g.mediaType;v=v||{},u("requestcanceled",{request_event_type:v.type+"_"+v.action,request_url:v.url,request_type:w,request_hostname:$(v.url)})};a.on("fragmentLoadingAbandoned",E);var q=function(g){var v=g.error,w,T,S=(v==null||(w=v.data)===null||w===void 0?void 0:w.request)||{},O=(v==null||(T=v.data)===null||T===void 0?void 0:T.response)||{};(v==null?void 0:v.code)===27&&u("requestfailed",{request_error:S.type+"_"+S.action,request_url:S.url,request_hostname:$(S.url),request_type:S.mediaType,request_error_code:O.status,request_error_text:O.statusText});var I="".concat(S!=null&&S.url?"url: ".concat(S.url,"\n"):"")+"".concat(O!=null&&O.status||O!=null&&O.statusText?"response: ".concat(O==null?void 0:O.status,", ").concat(O==null?void 0:O.statusText,"\n"):"");u("error",{player_error_code:v==null?void 0:v.code,player_error_message:v==null?void 0:v.message,player_error_context:I})};a.on("error",q),a._stopMuxMonitor=function(){a.off("manifestLoaded",s),a.off("initFragmentLoaded",c),a.off("mediaFragmentLoaded",p),a.off("qualityChangeRendered",x),a.off("error",q),a.off("fragmentLoadingAbandoned",E),delete a._stopMuxMonitor}},ar=function(e){e&&typeof e._stopMuxMonitor=="function"&&e._stopMuxMonitor()},Et=0,rr=function(){"use strict";function i(){U(this,i),f(this,"_listeners",void 0)}return ee(i,[{key:"on",value:function(t,a,r){return a._eventEmitterGuid=a._eventEmitterGuid||++Et,this._listeners=this._listeners||{},this._listeners[t]=this._listeners[t]||[],r&&(a=a.bind(r)),this._listeners[t].push(a),a}},{key:"off",value:function(t,a){var r=this._listeners&&this._listeners[t];r&&r.forEach(function(n,o){n._eventEmitterGuid===a._eventEmitterGuid&&r.splice(o,1)})}},{key:"one",value:function(t,a,r){var n=this;a._eventEmitterGuid=a._eventEmitterGuid||++Et;var o=function(){n.off(t,o),a.apply(r||this,arguments)};o._eventEmitterGuid=a._eventEmitterGuid,this.on(t,o)}},{key:"emit",value:function(t,a){var r=this;if(this._listeners){a=a||{};var n=this._listeners["before"+t]||[],o=this._listeners["before*"]||[],u=this._listeners[t]||[],s=this._listeners["after"+t]||[],d=function(y,c){y=y.slice(),y.forEach(function(l){l.call(r,{type:t},c)})};d(n,a),d(o,a),d(u,a),d(s,a)}}}]),i}(),ir=rr,$e=K(ae()),nr=function(){"use strict";function i(e){var t=this;U(this,i),f(this,"_playbackHeartbeatInterval",void 0),f(this,"_playheadShouldBeProgressing",void 0),f(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(a,r){t._playbackHeartbeatInterval!==null&&($e.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:r.viewer_time}),t._playbackHeartbeatInterval=null)})}return ee(i,[{key:"_startPlaybackHeartbeatInterval",value:function(){var t=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=$e.default.setInterval(function(){t.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&($e.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),i}(),or=nr,sr=function i(e){"use strict";var t=this;U(this,i),f(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(a,r){try{var n=e.errorTranslator({player_error_code:r.player_error_code,player_error_message:r.player_error_message,player_error_context:r.player_error_context,player_error_severity:r.player_error_severity,player_error_business_exception:r.player_error_business_exception});n&&(e.data.player_error_code=n.player_error_code||r.player_error_code,e.data.player_error_message=n.player_error_message||r.player_error_message,e.data.player_error_context=n.player_error_context||r.player_error_context,e.data.player_error_severity=n.player_error_severity||r.player_error_severity,e.data.player_error_business_exception=n.player_error_business_exception||r.player_error_business_exception,t.viewErrored=!0)}catch(o){e.mux.log.warn("Exception in error translator callback.",o),t.viewErrored=!0}}),e.on("aftererror",function(){var a,r,n,o,u;(a=e.data)===null||a===void 0||delete a.player_error_code,(r=e.data)===null||r===void 0||delete r.player_error_message,(n=e.data)===null||n===void 0||delete n.player_error_context,(o=e.data)===null||o===void 0||delete o.player_error_severity,(u=e.data)===null||u===void 0||delete u.player_error_business_exception})},ur=sr,dr=function(){"use strict";function i(e){U(this,i),f(this,"_watchTimeTrackerLastCheckedTime",void 0),f(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return ee(i,[{key:"_updateWatchTime",value:function(t,a){var r=a.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=r),B(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(t,a){this._updateWatchTime(t,a),this._watchTimeTrackerLastCheckedTime=null}}]),i}(),lr=dr,cr=function(){"use strict";function i(e){var t=this;U(this,i),f(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),f(this,"_lastTime",void 0),f(this,"_isAdPlaying",void 0),f(this,"_callbackUpdatePlaybackTime",void 0),f(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=F.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null,e.on("viewinit",function(){t.pm.data.view_playing_time_ms_cumulative=0});var a=this._startPlaybackTimeTracking.bind(this);e.on("playing",a),e.on("adplaying",a),e.on("seeked",a),e.on("rebufferend",a);var r=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",r),e.on("seeking",r),e.on("rebufferstart",r),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=F.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return ee(i,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this._lastTime=F.now(),this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var t=this.pm.data.player_playhead_time||0,a=F.now(),r=a-this._lastTime,n=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&t>this._playbackTimeTrackerLastPlayheadPosition?n=t-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(n=r),n>0&&n<=1e3&&B(this.pm.data,"view_content_playback_time",n),this._callbackUpdatePlaybackTime!==null&&r>0&&r<=1e3&&(this._isAdPlaying&&B(this.pm.data,"ad_playing_time_ms_cumulative",r),B(this.pm.data,"view_playing_time_ms_cumulative",r)),this._playbackTimeTrackerLastPlayheadPosition=t,this._lastTime=a}}]),i}(),_r=cr,pr=function(){"use strict";function i(e){U(this,i),f(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return ee(i,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position=="undefined"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(t,a){var r=this,n=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(a&&a.player_playhead_time)this.pm.data.player_playhead_time=a.player_playhead_time,n(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var o=this.pm.getPlayheadTime();typeof o!="undefined"&&(this.pm.data.player_playhead_time=o,n(),this._updateMaxPlayheadPosition())}}}]),i}(),vr=pr,Tt=5*60*1e3,hr=function i(e){"use strict";if(U(this,i),!e.disableRebufferTracking){var t,a=function(o,u){r(u),t=void 0},r=function(o){if(t){var u=o.viewer_time-t;B(e.data,"view_rebuffer_duration",u),t=o.viewer_time,e.data.view_rebuffer_duration>Tt&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(Tt,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(n,o){return r(o)}),e.on("rebufferstart",function(n,o){t||(B(e.data,"view_rebuffer_count",1),t=o.viewer_time,e.one("rebufferend",a))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",a)})}},fr=hr,mr=function(){"use strict";function i(e){var t=this;U(this,i),f(this,"_lastCheckedTime",void 0),f(this,"_lastPlayheadTime",void 0),f(this,"_lastPlayheadTimeUpdatedTime",void 0),f(this,"_rebuffering",void 0),f(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:F.now()})}))}return ee(i,[{key:"_checkIfRebuffering",value:function(t,a){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(t,a);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(a.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(t,a,!0);return}var r=a.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=a.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(t){this._lastCheckedTime=t,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=t}},{key:"_cleanupRebufferTracker",value:function(t,a){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:a.viewer_time});else{if(this._lastCheckedTime===null)return;var n=this.pm.data.player_playhead_time-this._lastPlayheadTime,o=a.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&n>0&&o-n>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+o-n}))}r?this._prepareRebufferTrackerState(a.viewer_time):this._clearRebufferTrackerState()}}]),i}(),yr=mr,gr=function(){"use strict";function i(e){var t=this;U(this,i),f(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var a=e.data,r=a.view_id;if(!a.view_program_changed){var n=function(u,s){var d=s.viewer_time;(u.type==="playing"&&typeof e.data.view_time_to_first_frame=="undefined"||u.type==="adplaying"&&(typeof e.data.view_time_to_first_frame=="undefined"||t._inPrerollPosition()))&&t.calculateTimeToFirstFrame(d||F.now(),r)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return ee(i,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(t,a){a===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:t}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.pm.pageLoadInitTime&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.pm.pageLoadInitTime))}}]),i}(),br=gr,Er=function i(e){"use strict";var t=this;U(this,i),f(this,"_lastPlayerHeight",void 0),f(this,"_lastPlayerWidth",void 0),f(this,"_lastPlayheadPosition",void 0),f(this,"_lastSourceHeight",void 0),f(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var a=["pause","rebufferstart","seeking","error","adbreakstart","hb","renditionchange","orientationchange","viewend","playbackmodechange"],r=["playing","hb","renditionchange","orientationchange","playbackmodechange"];a.forEach(function(n){e.on(n,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var o=e.data.player_playhead_time-t._lastPlayheadPosition;if(o<0){t._lastPlayheadPosition=-1;return}var u=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),s=Math.max(0,u-1),d=Math.max(0,1-u);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,s),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,d),B(e.data,"view_total_content_playback_time",o),B(e.data,"view_total_upscaling",s*o),B(e.data,"view_total_downscaling",d*o)}t._lastPlayheadPosition=-1})}),r.forEach(function(n){e.on(n,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},Tr=Er,wr=2e3,kr=function i(e){"use strict";var t=this;U(this,i),f(this,"isSeeking",void 0),this.isSeeking=!1;var a=-1,r=function(){var o=F.now(),u=(e.data.viewer_time||o)-(a||o);B(e.data,"view_seek_duration",u),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,u),t.isSeeking=!1,a=-1};e.on("seeking",function(n,o){if(Object.assign(e.data,o),t.isSeeking&&o.viewer_time-a<=wr){a=o.viewer_time;return}t.isSeeking&&r(),t.isSeeking=!0,a=o.viewer_time,B(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){r()}),e.on("viewend",function(){t.isSeeking&&(r(),e.send("seeked")),t.isSeeking=!1,a=-1})},Dr=kr,wt=function(e,t){e.push(t),e.sort(function(a,r){return a.viewer_time-r.viewer_time})},Ar=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],xr=function(){"use strict";function i(e){var t=this;U(this,i),f(this,"_adHasPlayed",void 0),f(this,"_adRequests",void 0),f(this,"_adResponses",void 0),f(this,"_currentAdRequestNumber",void 0),f(this,"_currentAdResponseNumber",void 0),f(this,"_prerollPlayTime",void 0),f(this,"_wouldBeNewAdPlay",void 0),f(this,"isAdBreak",void 0),f(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),Ar.forEach(function(r){return e.on(r,t._updateAdData.bind(t))});var a=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",a),e.on("playing",a),e.on("viewend",a),e.on("adrequest",function(r,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},n),wt(t._adRequests,n),B(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||B(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(r,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},n),wt(t._adResponses,n);var o=t.findAdRequest(n.ad_request_id);o&&B(e.data,"view_ad_request_time",Math.max(0,n.viewer_time-o.viewer_time))}),e.on("adplay",function(r,n){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,B(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,n.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,n.viewer_time-e.data.view_start)),t._prerollPlayTime=n.viewer_time)}),e.on("adplaying",function(r,n){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time=="undefined"&&typeof t._prerollPlayTime!="undefined"&&(e.data.view_preroll_load_time=n.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=n.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(r,n){t._wouldBeNewAdPlay||B(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(r,n){t._wouldBeNewAdPlay||B(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return ee(i,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(t){for(var a=0;a<this._adRequests.length;a++)if(this._adRequests[a].ad_request_id===t)return this._adRequests[a]}},{key:"_updateAdData",value:function(t,a){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&a.ad_tag_url){var r=re(Oe(a.ad_tag_url),2),n=r[0],o=r[1];this.pm.data.view_preroll_ad_tag_domain=o,this.pm.data.view_preroll_ad_tag_hostname=n}if(!this.pm.data.view_preroll_ad_asset_hostname&&a.ad_asset_url){var u=re(Oe(a.ad_asset_url),2),s=u[0],d=u[1];this.pm.data.view_preroll_ad_asset_domain=d,this.pm.data.view_preroll_ad_asset_hostname=s}this.pm.data.ad_type="preroll"}this.pm.data.ad_asset_url=a==null?void 0:a.ad_asset_url,this.pm.data.ad_tag_url=a==null?void 0:a.ad_tag_url,this.pm.data.ad_creative_id=a==null?void 0:a.ad_creative_id,this.pm.data.ad_id=a==null?void 0:a.ad_id,this.pm.data.ad_universal_id=a==null?void 0:a.ad_universal_id,a!=null&&a.ad_type&&(this.pm.data.ad_type=a==null?void 0:a.ad_type)}}]),i}(),Sr=xr,Rr=function i(e){"use strict";var t=this;U(this,i),f(this,"lastWallClockTime",void 0);var a=function(){t.lastWallClockTime=F.now(),e.on("before*",r)},r=function(o){var u=F.now(),s=t.lastWallClockTime;t.lastWallClockTime=u,u-s>3e4&&(e.emit("devicesleep",{viewer_time:s}),Object.assign(e.data,{viewer_time:s}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:u}),Object.assign(e.data,{viewer_time:u}),e.send("devicewake"))};e.one("playbackheartbeat",a),e.on("playbackheartbeatend",function(){e.off("before*",r),e.one("playbackheartbeat",a)})},Or=Rr,et=K(ae()),Ut=function(i){return i()}(function(){var i=function(){for(var a=0,r={};a<arguments.length;a++){var n=arguments[a];for(var o in n)r[o]=n[o]}return r};function e(t){function a(r,n,o){var u;if(typeof document!="undefined"){if(arguments.length>1){if(o=i({path:"/"},a.defaults,o),typeof o.expires=="number"){var s=new Date;s.setMilliseconds(s.getMilliseconds()+o.expires*864e5),o.expires=s}try{u=JSON.stringify(n),/^[\{\[]/.test(u)&&(n=u)}catch(h){}return t.write?n=t.write(n,r):n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),r=encodeURIComponent(String(r)),r=r.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),r=r.replace(/[\(\)]/g,escape),document.cookie=[r,"=",n,o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}r||(u={});for(var d=document.cookie?document.cookie.split("; "):[],_=/(%[0-9A-Z]{2})+/g,y=0;y<d.length;y++){var c=d[y].split("="),l=c.slice(1).join("=");l.charAt(0)==='"'&&(l=l.slice(1,-1));try{var p=c[0].replace(_,decodeURIComponent);if(l=t.read?t.read(l,p):t(l,p)||l.replace(_,decodeURIComponent),this.json)try{l=JSON.parse(l)}catch(h){}if(r===p){u=l;break}r||(u[p]=l)}catch(h){}}return u}}return a.set=a,a.get=function(r){return a.call(a,r)},a.getJSON=function(){return a.apply({json:!0},[].slice.call(arguments))},a.defaults={},a.remove=function(r,n){a(r,"",i(n,{expires:-1}))},a.withConverter=e,a}return e(function(){})}),Bt="muxData",Pr=function(e){return Object.entries(e).map(function(t){var a=re(t,2),r=a[0],n=a[1];return"".concat(r,"=").concat(n)}).join("&")},Lr=function(e){return e.split("&").reduce(function(t,a){var r=re(a.split("="),2),n=r[0],o=r[1],u=+o,s=o&&u==o?u:o;return t[n]=s,t},{})},Ft=function(){var e;try{e=Lr(Ut.get(Bt)||"")}catch(t){e={}}return e},Jt=function(e){try{Ut.set(Bt,Pr(e),{expires:365})}catch(t){}},qr=function(){var e=Ft();return e.mux_viewer_id=e.mux_viewer_id||Re(),e.msn=e.msn||Math.random(),Jt(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},Ir=function(){var e=Ft(),t=F.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=Re(),e.sst=t),e.sex=t+25*60*1e3,Jt(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}};function Nr(i,e){var t=e.beaconCollectionDomain,a=e.beaconDomain;if(t)return"https://"+t;i=i||"inferred";var r=a||"litix.io";return i.match(/^[a-z0-9]+$/)?"https://"+i+"."+r:"https://img.litix.io/a.gif"}var Cr=K(ae()),Gt=function(){var e;switch(Qt()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},Qt=function(){var e=Cr.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};Gt.getConnectionFromAPI=Qt;var jr=Gt,Mr={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},Hr=Vt(Mr),Ur={ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cm:"cmcd",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cv:"cumulative",cx:"connection",cz:"context",da:"data",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mp:"mode",ms:"ms",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",pv:"previous",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},kt=Vt(Ur);function Vt(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function ot(i){var e={},t={};return Object.keys(i).forEach(function(a){var r=!1;if(i.hasOwnProperty(a)&&i[a]!==void 0){var n=a.split("_"),o=n[0],u=Hr[o];u||(N.info("Data key word `"+n[0]+"` not expected in "+a),u=o+"_"),n.splice(1).forEach(function(s){s==="url"&&(r=!0),kt[s]?u+=kt[s]:Number.isInteger(Number(s))?u+=s:(N.info("Data key word `"+s+"` not expected in "+a),u+="_"+s+"_")}),r?t[u]=i[a]:e[u]=i[a]}}),Object.assign(e,t)}var pe=K(ae()),Br=K(Nt()),Fr={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},Jr=56*1024,Gr=["hb","requestcompleted","requestfailed","requestcanceled"],Qr="https://img.litix.io",ie=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=e||Qr,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},Fr,t)};ie.prototype.queueEvent=function(i,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||i==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};ie.prototype.flushEvents=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(i&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};ie.prototype.destroy=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,i?this._clearBeaconQueue():this.flushEvents(),pe.default.clearTimeout(this._sendTimeout)};ie.prototype._clearBeaconQueue=function(){var i=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(i);i>0&&Object.assign(e[e.length-1],ot({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);Wt(this._beaconUrl,t,!0,function(){})};ie.prototype._sendBeaconQueue=function(){var i=this;if(this._postInFlight){this._resendAfterPost=!0;return}var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),a=F.now();Wt(this._beaconUrl,t,!1,function(r,n){n?(i._eventQueue=e.concat(i._eventQueue),i._failureCount+=1,N.info("Error sending beacon: "+n)):i._failureCount=0,i._roundTripTime=F.now()-a,i._postInFlight=!1,i._resendAfterPost&&(i._resendAfterPost=!1,i._eventQueue.length>0&&i._sendBeaconQueue())})};ie.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var i=Math.pow(2,this._failureCount-1);return i=i*Math.random(),(1+i)*this._options.baseTimeBetweenBeacons};ie.prototype._startBeaconSending=function(){var i=this;pe.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=pe.default.setTimeout(function(){i._eventQueue.length&&i._sendBeaconQueue(),i._startBeaconSending()},this._getNextBeaconTime()))};ie.prototype._createPayload=function(i){var e=this,t={transmission_timestamp:Math.round(F.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var a,r,n,o=function(){a=JSON.stringify({metadata:t,events:r||i}),n=a.length/1024},u=function(){return n<=e._options.maxPayloadKBSize};return o(),u()||(N.info("Payload size is too big ("+n+" kb). Removing unnecessary events."),r=i.filter(function(s){return Gr.indexOf(s.e)===-1}),o()),u()||(N.info("Payload size still too big ("+n+" kb). Cropping fields.."),r.forEach(function(s){for(var d in s){var _=s[d],y=50*1024;typeof _=="string"&&_.length>y&&(s[d]=_.substring(0,y))}}),o()),a};var Vr=typeof Br.default.exitPictureInPicture=="function"?function(e){return e.length<=Jr}:function(i){return!1},Wt=function(e,t,a,r){if(a&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t)){r();return}if(pe.default.fetch){pe.default.fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:Vr(t)}).then(function(o){return r(null,o.ok?null:"Error")}).catch(function(o){return r(null,o)});return}if(pe.default.XMLHttpRequest){var n=new pe.default.XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4)return r(null,n.status!==200?"error":void 0)},n.open("POST",e),n.setRequestHeader("Content-Type","text/plain"),n.send(t);return}r()},Wr=ie,zr=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception","view_playing_time_ms_cumulative","ad_playing_time_ms_cumulative"],Kr=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],Yr=["ad_id","ad_creative_id","ad_universal_id"],Xr=["viewstart","error","ended","viewend"],Zr=10*60*1e3,$r=function(){"use strict";function i(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};U(this,i);var r,n,o,u,s,d,_,y,c,l,p,h;f(this,"mux",void 0),f(this,"envKey",void 0),f(this,"options",void 0),f(this,"eventQueue",void 0),f(this,"sampleRate",void 0),f(this,"disableCookies",void 0),f(this,"respectDoNotTrack",void 0),f(this,"previousBeaconData",void 0),f(this,"lastEventTime",void 0),f(this,"rateLimited",void 0),f(this,"pageLevelData",void 0),f(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=a,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new Wr(Nr(this.envKey,this.options));var D;this.sampleRate=(D=this.options.sampleRate)!==null&&D!==void 0?D:1;var x;this.disableCookies=(x=this.options.disableCookies)!==null&&x!==void 0?x:!1;var E;this.respectDoNotTrack=(E=this.options.respectDoNotTrack)!==null&&E!==void 0?E:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(r=this.options.platform)===null||r===void 0?void 0:r.name,viewer_application_version:(n=this.options.platform)===null||n===void 0?void 0:n.version,viewer_application_engine:(o=this.options.platform)===null||o===void 0?void 0:o.layout,viewer_device_name:(u=this.options.platform)===null||u===void 0?void 0:u.product,viewer_device_category:"",viewer_device_manufacturer:(s=this.options.platform)===null||s===void 0?void 0:s.manufacturer,viewer_os_family:(_=this.options.platform)===null||_===void 0||(d=_.os)===null||d===void 0?void 0:d.family,viewer_os_architecture:(c=this.options.platform)===null||c===void 0||(y=c.os)===null||y===void 0?void 0:y.architecture,viewer_os_version:(p=this.options.platform)===null||p===void 0||(l=p.os)===null||l===void 0?void 0:l.version,viewer_connection_type:jr(),page_url:et.default===null||et.default===void 0||(h=et.default.location)===null||h===void 0?void 0:h.href},this.viewerData=this.disableCookies?{}:qr()}return ee(i,[{key:"send",value:function(t,a){if(!(!t||!(a!=null&&a.view_id))){if(this.respectDoNotTrack&&it())return N.info("Not sending `"+t+"` because Do Not Track is enabled");if(!a||typeof a!="object")return N.error("A data object was expected in send() but was not provided");var r=this.disableCookies?{}:Ir(),n=st(Je({},this.pageLevelData,a,r,this.viewerData),{event:t,env_key:this.envKey});n.user_id&&(n.viewer_user_id=n.user_id,delete n.user_id);var o,u=((o=n.mux_sample_number)!==null&&o!==void 0?o:0)>=this.sampleRate,s=this._deduplicateBeaconData(t,n),d=ot(s);if(this.lastEventTime=this.mux.utils.now(),u)return N.info("Not sending event due to sample rate restriction",t,n,d);if(this.envKey||N.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",t,n,d),!this.rateLimited)if(N.info("Sending event",t,n,d),this.rateLimited=!this.eventQueue.queueEvent(t,d),this.mux.WINDOW_UNLOADING&&t==="viewend")this.eventQueue.destroy(!0);else{if(this.mux.WINDOW_HIDDEN&&t==="hb")this.eventQueue.flushEvents(!0);else if(Xr.indexOf(t)>=0){if(t==="error"&&a.player_error_severity==="warning")return;this.eventQueue.flushEvents()}if(this.rateLimited)return n.event="eventrateexceeded",d=ot(n),this.eventQueue.queueEvent(n.event,d),N.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(t,a){var r=this,n={},o=a.view_id;if(o==="-1"||t==="viewstart"||t==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=Zr)n=Je({},a),o&&(this.previousBeaconData=n),o&&t==="viewend"&&(this.previousBeaconData=null);else{var u=t.indexOf("request")===0;Object.entries(a).forEach(function(s){var d=re(s,2),_=d[0],y=d[1];r.previousBeaconData&&(y!==r.previousBeaconData[_]||zr.indexOf(_)>-1||r.objectHasChanged(u,_,y,r.previousBeaconData[_])||r.eventRequiresKey(t,_))&&(n[_]=y,r.previousBeaconData[_]=y)})}return n}},{key:"objectHasChanged",value:function(t,a,r,n){return!t||a.indexOf("request_")!==0?!1:a==="request_response_headers"||typeof r!="object"||typeof n!="object"?!0:Object.keys(r||{}).length!==Object.keys(n||{}).length}},{key:"eventRequiresKey",value:function(t,a){return!!(t==="renditionchange"&&a.indexOf("video_source_")===0||Yr.includes(a)&&Kr.includes(t))}}]),i}(),ei=function i(e){"use strict";U(this,i);var t=0,a=0,r=0,n=0,o=0,u=0,s=0,d=function(l,p){var h=p.request_start,D=p.request_response_start,x=p.request_response_end,E=p.request_bytes_loaded;n++;var q,b;if(D?(q=D-(h!=null?h:0),b=(x!=null?x:0)-D):b=(x!=null?x:0)-(h!=null?h:0),b>0&&E&&E>0){var g=E/b*8e3;o++,a+=E,r+=b,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,g),e.data.view_average_request_throughput=a/r*8e3,e.data.view_request_count=n,q>0&&(t+=q,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,q),e.data.view_average_request_latency=t/o)}},_=function(l,p){n++,u++,e.data.view_request_count=n,e.data.view_request_failed_count=u},y=function(l,p){n++,s++,e.data.view_request_count=n,e.data.view_request_canceled_count=s};e.on("requestcompleted",d),e.on("requestfailed",_),e.on("requestcanceled",y)},ti=ei,ai=60*60*1e3,ri=function i(e){"use strict";var t=this;U(this,i),f(this,"_lastEventTime",void 0),e.on("before*",function(a,r){var n=r.viewer_time,o=F.now(),u=t._lastEventTime;if(t._lastEventTime=o,u&&o-u>ai){var s=Object.keys(e.data).reduce(function(_,y){return y.indexOf("video_")===0?Object.assign(_,f({},y,e.data[y])):_},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var d=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:n},s)),e.playbackHeartbeat._playheadShouldBeProgressing=d,e.playbackHeartbeat._playheadShouldBeProgressing&&a.type!=="play"&&a.type!=="adbreakstart"&&(e.emit("play",{viewer_time:n}),a.type!=="playing"&&e.emit("playing",{viewer_time:n}))}})},ii=ri,ni=function i(e){"use strict";U(this,i);var t=function(s){var d=oi(s),_=si(s);if(d!=null&&!Dt(d,n)&&o<=_){n=d,o=_;var y={video_cdn:d};e.emit("cdnchange",y)}},a=null,r=null,n=null,o=0;e.on("viewinit",function(){a=null,r=null,n=null,o=0}),e.on("beforecdnchange",function(u,s){var d=s==null?void 0:s.video_cdn;d&&(typeof s.video_previous_cdn=="undefined"||s.video_previous_cdn===null)&&(Dt(d,r)?s.video_previous_cdn=a!=null?a:void 0:(s.video_previous_cdn=r!=null?r:void 0,a=r,r=d))}),e.on("requestcompleted",function(u,s){t(s)})};function Dt(i,e){return(i==null?void 0:i.toLowerCase())===(e==null?void 0:e.toLowerCase())}function oi(i){var e;return i!=null&&i.request_type&&(i.request_type==="media"||i.request_type==="video")&&!((e=i.request_response_headers)===null||e===void 0)&&e["x-cdn"]?i.request_response_headers["x-cdn"]:i!=null&&i.video_cdn?i.video_cdn:null}function si(i){return i!=null&&i.request_start?i.request_start:i!=null&&i.viewer_time?i.viewer_time:Date.now()}var ui=ni,di=function(e){try{return JSON.parse(e),!0}catch(t){return!1}},li=function i(e){"use strict";var t=this;U(this,i),f(this,"_emittingAutomaticEvent",!1),f(this,"_hasInitialized",!1),f(this,"_currentMode","standard"),e.on("viewstart",function(){t._hasInitialized||(t._hasInitialized=!0,t._currentMode=e.data.player_playback_mode||"standard",t._emittingAutomaticEvent=!0,e.emit("playbackmodechange",{player_playback_mode:t._currentMode,player_playback_mode_data:"{}"}),t._emittingAutomaticEvent=!1)}),e.on("viewend",function(){t._hasInitialized=!1}),e.on("playbackmodechange",function(a,r){t._emittingAutomaticEvent||(r.player_playback_mode_data?di(r.player_playback_mode_data)||(e.mux.log.warn("Invalid JSON string for player_playback_mode_data"),r.player_playback_mode_data="{}"):r.player_playback_mode_data="{}",e.data.player_playback_mode_data=r.player_playback_mode_data,e.data.player_playback_mode=r.player_playback_mode,t._currentMode=r.player_playback_mode)})},ci=li,_i=function(){"use strict";function i(e){U(this,i),f(this,"pm",void 0),f(this,"_currentRangeStart",void 0),f(this,"_lastPlayheadTime",void 0),this.pm=e,this._currentRangeStart=null,this._lastPlayheadTime=null,e.on("playbackheartbeat",this._updatePlaybackRange.bind(this)),e.on("playbackheartbeatend",this._endPlaybackRange.bind(this))}return ee(i,[{key:"_updateLastRangeEnd",value:function(){var t=this.pm.data.video_playback_ranges;if(t&&t.length>0){var a=this.pm.data.player_playhead_time||0;t[t.length-1][1]=a}}},{key:"_updatePlaybackRange",value:function(){var t,a=this.pm.data.player_playhead_time||0;if(!(!this.pm.disableAdPlaybackRangeFiltering&&!((t=this.pm.adTracker)===null||t===void 0)&&t.isAdBreak&&this._lastPlayheadTime!==null&&a<this._lastPlayheadTime)){if(this._lastPlayheadTime!==null&&this._currentRangeStart!==null){var r=Math.abs(a-this._lastPlayheadTime);if(r>1e3){var n=this.pm.data.video_playback_ranges;n&&n.length>0&&(n[n.length-1][1]=this._lastPlayheadTime),this._currentRangeStart=null}}if(this._currentRangeStart===null){var o=this.pm.data.video_playback_ranges||[];o.length>0&&o[o.length-1][1]===a?this._currentRangeStart=o[o.length-1][0]:(this._currentRangeStart=a,o.push([a,a])),this.pm.data.video_playback_ranges=o}else this._updateLastRangeEnd();this._lastPlayheadTime=a}}},{key:"_endPlaybackRange",value:function(){this._currentRangeStart!==null&&(this._updateLastRangeEnd(),this._currentRangeStart=null,this._lastPlayheadTime=null)}}]),i}(),pi=_i,vi=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange","cdnchange","playbackmodechange"],hi=new Set(["requestcompleted","requestfailed","requestcanceled"]),fi=function(i){"use strict";Ha(t,i);var e=Ga(t);function t(a,r,n){U(this,t);var o;o=e.call(this),f(k(o),"pageLoadEndTime",void 0),f(k(o),"pageLoadInitTime",void 0),f(k(o),"_destroyed",void 0),f(k(o),"_heartBeatTimeout",void 0),f(k(o),"adTracker",void 0),f(k(o),"dashjs",void 0),f(k(o),"data",void 0),f(k(o),"disablePlayheadRebufferTracking",void 0),f(k(o),"disableRebufferTracking",void 0),f(k(o),"disableAdPlaybackRangeFiltering",void 0),f(k(o),"errorTracker",void 0),f(k(o),"errorTranslator",void 0),f(k(o),"emitTranslator",void 0),f(k(o),"getAdData",void 0),f(k(o),"getPlayheadTime",void 0),f(k(o),"getStateData",void 0),f(k(o),"stateDataTranslator",void 0),f(k(o),"hlsjs",void 0),f(k(o),"id",void 0),f(k(o),"longResumeTracker",void 0),f(k(o),"minimumRebufferDuration",void 0),f(k(o),"mux",void 0),f(k(o),"playbackEventDispatcher",void 0),f(k(o),"playbackHeartbeat",void 0),f(k(o),"playbackHeartbeatTime",void 0),f(k(o),"playheadTime",void 0),f(k(o),"seekingTracker",void 0),f(k(o),"sustainedRebufferThreshold",void 0),f(k(o),"watchTimeTracker",void 0),f(k(o),"currentFragmentPDT",void 0),f(k(o),"currentFragmentStart",void 0),o.pageLoadInitTime=Fe.navigationStart(),o.pageLoadEndTime=Fe.domContentLoadedEventEnd();var u={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,disableAdPlaybackRangeFiltering:!1,errorTranslator:function(l){return l},emitTranslator:function(){for(var l=arguments.length,p=new Array(l),h=0;h<l;h++)p[h]=arguments[h];return p},stateDataTranslator:function(l){return l}};o.mux=a,o.id=r,n!=null&&n.beaconDomain&&o.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),n=Object.assign(u,n),n.data=n.data||{},n.data.property_key&&(n.data.env_key=n.data.property_key,delete n.data.property_key),N.level=n.debug?_e.DEBUG:_e.WARN,o.getPlayheadTime=n.getPlayheadTime,o.getStateData=n.getStateData||function(){return{}},o.getAdData=n.getAdData||function(){},o.minimumRebufferDuration=n.minimumRebufferDuration,o.sustainedRebufferThreshold=n.sustainedRebufferThreshold,o.playbackHeartbeatTime=n.playbackHeartbeatTime,o.disableRebufferTracking=n.disableRebufferTracking,o.disableRebufferTracking&&o.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),o.disablePlayheadRebufferTracking=n.disablePlayheadRebufferTracking,o.disableAdPlaybackRangeFiltering=n.disableAdPlaybackRangeFiltering,o.errorTranslator=n.errorTranslator,o.emitTranslator=n.emitTranslator,o.stateDataTranslator=n.stateDataTranslator,o.playbackEventDispatcher=new $r(a,n.data.env_key,n),o.data={player_instance_id:Re(),mux_sample_rate:n.sampleRate,beacon_domain:n.beaconCollectionDomain||n.beaconDomain},o.data.view_sequence_number=1,o.data.player_sequence_number=1;var s=function(){typeof this.data.view_start=="undefined"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"),this.emit("renditionchange"))}.bind(k(o));if(o.on("viewinit",function(c,l){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,l),this._initializeViewData(),this.one("play",s),this.one("adbreakstart",s)}),o.on("videochange",function(c,l){this._resetView(l)}),o.on("programchange",function(c,l){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(l,{view_program_changed:!0})),s(),this.emit("play"),this.emit("playing")}),o.on("fragmentchange",function(c,l){this.currentFragmentPDT=l.currentFragmentPDT,this.currentFragmentStart=l.currentFragmentStart}),o.on("destroy",o.destroy),typeof window!="undefined"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var d=function(){var l=typeof o.data.view_start!="undefined";o.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",l&&o.mux.WINDOW_HIDDEN&&(o.data.player_is_paused||o.emit("hb"))};window.addEventListener("visibilitychange",d,!1);var _=function(l){l.persisted||o.destroy()};window.addEventListener("pagehide",_,!1),o.on("destroy",function(){window.removeEventListener("visibilitychange",d),window.removeEventListener("pagehide",_)})}o.on("playerready",function(c,l){Object.assign(this.data,l)}),vi.forEach(function(c){o.on(c,function(l,p){c.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,p),this._sanitizeData()}),o.on("after"+c,function(){(c!=="error"||this.errorTracker.viewErrored)&&this.send(c)})}),o.on("viewend",function(c,l){Object.assign(o.data,l)});var y=function(l){var p=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=p-this.data.player_init_time),this.pageLoadInitTime=this.data.page_load_init_time||this.pageLoadInitTime,this.pageLoadEndTime=this.data.page_load_end_time||this.pageLoadEndTime,!this.mux.PLAYER_TRACKED&&this.pageLoadInitTime&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.pageLoadEndTime)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.pageLoadEndTime||1/0)-this.pageLoadInitTime)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return o.one("playerready",y),o.longResumeTracker=new ii(k(o)),o.errorTracker=new ur(k(o)),new Or(k(o)),o.seekingTracker=new Dr(k(o)),o.playheadTime=new vr(k(o)),o.playbackHeartbeat=new or(k(o)),new Tr(k(o)),o.watchTimeTracker=new lr(k(o)),new _r(k(o)),new pi(k(o)),o.adTracker=new Sr(k(o)),new yr(k(o)),new fr(k(o)),new br(k(o)),new ti(k(o)),new ui(k(o)),new ci(k(o)),n.hlsjs&&o.addHLSJS(n),n.dashjs&&o.addDashJS(n),o.emit("viewinit",n.data),o}return ee(t,[{key:"emit",value:function(r,n){var o,u=Object.assign({viewer_time:this.mux.utils.now()},n),s=[r,u];if(this.emitTranslator)try{s=this.emitTranslator(r,u)}catch(d){this.mux.log.warn("Exception in emit translator callback.",d)}s!=null&&s.length&&(o=Ue(be(t.prototype),"emit",this)).call.apply(o,[this].concat(Z(s)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start!="undefined"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(r){if(this.data.view_id){var n=Object.assign({},this.data),o=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(n.video_source_is_live===void 0&&(n.player_source_duration===1/0||n.video_source_duration===1/0?n.video_source_is_live=!0:(n.player_source_duration>0||n.video_source_duration>0)&&(n.video_source_is_live=!1)),n.video_source_is_live||o.forEach(function(_){n[_]=void 0}),n.video_source_url=n.video_source_url||n.player_source_url,n.video_source_url){var u=re(Oe(n.video_source_url),2),s=u[0],d=u[1];n.video_source_domain=d,n.video_source_hostname=s}delete n.ad_request_id,n.video_playback_ranges&&(n.video_playback_range=JSON.stringify(n.video_playback_ranges.filter(function(_){return _[0]!==_[1]}).map(function(_){return"".concat(_[0],":").concat(_[1])})),delete n.video_playback_ranges),this.playbackEventDispatcher.send(r,n),this.data.view_sequence_number++,this.data.player_sequence_number++,hi.has(r)||this._restartHeartBeat(),r==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(r){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",r)}},{key:"_updateStateData",value:function(){var r,n=this.getStateData();if(typeof this.stateDataTranslator=="function")try{n=this.stateDataTranslator(n)}catch(s){this.mux.log.warn("Exception in stateDataTranslator translator callback.",s)}if(!((r=this.data)===null||r===void 0)&&r.video_cdn&&n!=null&&n.video_cdn){var o=n.video_cdn,u=Ba(n,["video_cdn"]);n=u}Object.assign(this.data,n),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var r=this,n=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];n.forEach(function(u){var s=parseInt(r.data[u],10);r.data[u]=isNaN(s)?void 0:s});var o=["player_source_url","video_source_url"];o.forEach(function(u){if(r.data[u]){var s=r.data[u].toLowerCase();(s.indexOf("data:")===0||s.indexOf("blob:")===0)&&(r.data[u]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var r=this;Object.keys(this.data).forEach(function(n){n.indexOf("video_")===0&&delete r.data[n]})}},{key:"_resetViewData",value:function(){var r=this;Object.keys(this.data).forEach(function(n){n.indexOf("view_")===0&&delete r.data[n]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var r=this,n=this.data.view_id=Re(),o=function(){n===r.data.view_id&&B(r.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",o):o()}},{key:"_restartHeartBeat",value:function(){var r=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){r.data.player_is_paused||r.emit("hb")},1e4)}},{key:"addHLSJS",value:function(r){if(!r.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=r.hlsjs,Ya(this.mux,this.id,r.hlsjs,{},r.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(Xa(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(r){if(!r.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=r.dashjs,tr(this.mux,this.id,r.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(ar(this.dashjs),this.dashjs=void 0)}}]),t}(ir),mi=fi,Ae=K(Nt());function tt(){return Ae.default&&!!(Ae.default.fullscreenElement||Ae.default.webkitFullscreenElement||Ae.default.mozFullScreenElement||Ae.default.msFullscreenElement)}var yi=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],gi={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function bi(i,e,t){var a=re(Be(e),3),r=a[0],n=a[1],o=a[2],u=i.log,s=i.utils.getComputedStyle,d=i.utils.secondsToMs,_={automaticErrorTracking:!0};if(r){if(o!=="video"&&o!=="audio")return u.error("The element of `"+n+"` was not a media element.")}else return u.error("No element was found with the `"+n+"` query selector.");r.mux&&(r.mux.destroy(),delete r.mux,u.warn("Already monitoring this video element, replacing existing event listeners"));var y={getPlayheadTime:function(){return d(r.currentTime)},getStateData:function(){var p,h,D,x=((p=(h=this).getPlayheadTime)===null||p===void 0?void 0:p.call(h))||d(r.currentTime),E=this.hlsjs&&this.hlsjs.url,q=this.dashjs&&typeof this.dashjs.getSource=="function"&&this.dashjs.getSource(),b={player_is_paused:r.paused,player_width:parseInt(s(r,"width")),player_height:parseInt(s(r,"height")),player_autoplay_on:r.autoplay,player_preload_on:r.preload,player_language_code:r.lang,player_is_fullscreen:tt(),video_poster_url:r.poster,video_source_url:E||q||r.currentSrc,video_source_duration:d(r.duration),video_source_height:r.videoHeight,video_source_width:r.videoWidth,view_dropped_frame_count:r==null||(D=r.getVideoPlaybackQuality)===null||D===void 0?void 0:D.call(r).droppedVideoFrames};if(r.getStartDate&&x>0){var g=r.getStartDate();if(g&&typeof g.getTime=="function"&&g.getTime()){var v=g.getTime();if(b.player_program_time=v+x,r.seekable.length>0){var w=v+r.seekable.end(r.seekable.length-1);b.player_live_edge_program_time=w}}}return b}};t=Object.assign(_,t,y),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:i.VERSION},t.data),r.mux=r.mux||{},r.mux.deleted=!1,r.mux.emit=function(l,p){i.emit(n,l,p)},r.mux.updateData=function(l){r.mux.emit("hb",l)};var c=function(){u.error("The monitor for this video element has already been destroyed.")};r.mux.destroy=function(){Object.keys(r.mux.listeners).forEach(function(l){r.removeEventListener(l,r.mux.listeners[l],!1)}),delete r.mux.listeners,r.mux.fullscreenChangeListener&&(document.removeEventListener("fullscreenchange",r.mux.fullscreenChangeListener,!1),delete r.mux.fullscreenChangeListener),r.mux.destroy=c,r.mux.swapElement=c,r.mux.emit=c,r.mux.addHLSJS=c,r.mux.addDashJS=c,r.mux.removeHLSJS=c,r.mux.removeDashJS=c,r.mux.updateData=c,r.mux.setEmitTranslator=c,r.mux.setStateDataTranslator=c,r.mux.setGetPlayheadTime=c,r.mux.deleted=!0,i.emit(n,"destroy")},r.mux.swapElement=function(l){var p=re(Be(l),3),h=p[0],D=p[1],x=p[2];if(h){if(x!=="video"&&x!=="audio")return i.log.error("The element of `"+D+"` was not a media element.")}else return i.log.error("No element was found with the `"+D+"` query selector.");h.muxId=r.muxId,delete r.muxId,h.mux=h.mux||{},h.mux.listeners=Object.assign({},r.mux.listeners),delete r.mux.listeners,Object.keys(h.mux.listeners).forEach(function(E){r.removeEventListener(E,h.mux.listeners[E],!1),h.addEventListener(E,h.mux.listeners[E],!1)}),h.mux.fullscreenChangeListener=r.mux.fullscreenChangeListener,delete r.mux.fullscreenChangeListener,h.mux.swapElement=r.mux.swapElement,h.mux.destroy=r.mux.destroy,delete r.mux,r=h},r.mux.addHLSJS=function(l){i.addHLSJS(n,l)},r.mux.addDashJS=function(l){i.addDashJS(n,l)},r.mux.removeHLSJS=function(){i.removeHLSJS(n)},r.mux.removeDashJS=function(){i.removeDashJS(n)},r.mux.setEmitTranslator=function(l){i.setEmitTranslator(n,l)},r.mux.setStateDataTranslator=function(l){i.setStateDataTranslator(n,l)},r.mux.setGetPlayheadTime=function(l){l||(l=t.getPlayheadTime),i.setGetPlayheadTime(n,l)},i.init(n,t),i.emit(n,"playerready"),r.paused||(i.emit(n,"play"),r.readyState>2&&i.emit(n,"playing")),r.mux.listeners={},yi.forEach(function(l){l==="error"&&!t.automaticErrorTracking||(r.mux.listeners[l]=function(){var p={};if(l==="error"){if(!r.error||r.error.code===1)return;p.player_error_code=r.error.code,p.player_error_message=gi[r.error.code]||r.error.message}i.emit(n,l,p)},r.addEventListener(l,r.mux.listeners[l],!1))}),r.mux.listeners.enterpictureinpicture=function(){i.emit(n,"playbackmodechange",{player_playback_mode:"pip",player_playback_mode_data:"{}"})},r.mux.listeners.leavepictureinpicture=function(){var l=tt()?"fullscreen":"standard";i.emit(n,"playbackmodechange",{player_playback_mode:l,player_playback_mode_data:"{}"})},r.addEventListener("enterpictureinpicture",r.mux.listeners.enterpictureinpicture,!1),r.addEventListener("leavepictureinpicture",r.mux.listeners.leavepictureinpicture,!1),r.mux.fullscreenChangeListener=function(){var l=tt(),p=document.fullscreenElement;if(l&&(p===r||p!=null&&p.contains(r)))i.emit(n,"playbackmodechange",{player_playback_mode:"fullscreen",player_playback_mode_data:"{}"});else if(!l){var h=document.pictureInPictureElement===r,D=h?"pip":"standard";i.emit(n,"playbackmodechange",{player_playback_mode:D,player_playback_mode_data:"{}"})}},document.addEventListener("fullscreenchange",r.mux.fullscreenChangeListener,!1)}function Ei(i,e,t,a){var r=a;if(i&&typeof i[e]=="function")try{r=i[e].apply(i,t)}catch(n){N.info("safeCall error",n)}return r}var Se=K(ae()),ge;Se.default&&Se.default.WeakMap&&(ge=new WeakMap);function Ti(i,e){if(!i||!e||!Se.default||typeof Se.default.getComputedStyle!="function")return"";var t;return ge&&ge.has(i)&&(t=ge.get(i)),t||(t=Se.default.getComputedStyle(i,null),ge&&ge.set(i,t)),t.getPropertyValue(e)}function wi(i){return Math.floor(i*1e3)}var ce={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},Qe=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};Qe.prototype.process=function(i){var e;for(this.buffer+=i,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};Qe.prototype.processLine=function(i){var e=i.indexOf(":"),t=xi(i,e),a=t[0],r=t.length===2?dt(t[1]):void 0;if(a[0]!=="#")this.currentUri.uri=a,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(a){case ce.TARGET_DURATION:{if(!isFinite(r)||r<0)return;this.manifest.targetDuration=r,this.setHoldBack();break}case ce.PART_INF:{at(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case ce.SERVER_CONTROL:{at(this.manifest,t),this.setHoldBack();break}case ce.INF:{r===0?this.currentUri.duration=.01:r>0&&(this.currentUri.duration=r);break}case ce.PROGRAM_DATE_TIME:{var n=r,o=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=o),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=o;break}case ce.VERSION:{at(this.manifest,t);break}case ce.SESSION_DATA:{var u=Si(t[1]),s=Ht(u);Object.assign(this.manifest.sessionData,s)}}};Qe.prototype.setHoldBack=function(){var i=this.manifest,e=i.serverControl,t=i.targetDuration,a=i.partTargetDuration;if(e){var r="holdBack",n="partHoldBack",o=t&&t*3,u=a&&a*2;t&&!e.hasOwnProperty(r)&&(e[r]=o),o&&e[r]<o&&(e[r]=o),a&&!e.hasOwnProperty(n)&&(e[n]=a*3),a&&e[n]<u&&(e[n]=u)}};var at=function(e,t){var a=zt(t[0].replace("#EXT-X-","")),r;Ai(t[1])?(r={},r=Object.assign(Di(t[1]),r)):r=dt(t[1]),e[a]=r},zt=function(e){return e.toLowerCase().replace(/-(\w)/g,function(t){return t[1].toUpperCase()})},dt=function(e){if(e.toLowerCase()==="yes"||e.toLowerCase()==="no")return e.toLowerCase()==="yes";var t=e.indexOf(":")!==-1?e:parseFloat(e);return isNaN(t)?e:t},ki=function(e){var t={},a=e.split("=");if(a.length>1){var r=zt(a[0]);t[r]=dt(a[1])}return t},Di=function(e){for(var t=e.split(","),a={},r=0;t.length>r;r++){var n=t[r],o=ki(n);a=Object.assign(o,a)}return a},Ai=function(e){return e.indexOf("=")>-1},xi=function(e,t){return t===-1?[e]:[e.substring(0,t),e.substring(t+1)]},Si=function(e){var t={};if(e){var a=e.search(","),r=e.slice(0,a),n=e.slice(a+1),o=[r,n];return o.forEach(function(u,s){for(var d=u.replace(/['"]+/g,"").split("="),_=0;_<d.length;_++)d[_]==="DATA-ID"&&(t["DATA-ID"]=d[1-_]),d[_]==="VALUE"&&(t.VALUE=d[1-_])}),{data:t}}},Ri=Qe,Oi={safeCall:Ei,safeIncrement:B,getComputedStyle:Ti,secondsToMs:wi,assign:Object.assign,headersStringToObject:ut,cdnHeadersToRequestId:Ge,extractHostnameAndDomain:Oe,extractHostname:$,manifestParser:Ri,generateShortID:jt,generateUUID:Re,now:F.now,findMediaElement:Be},Pi=Oi,Li={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",PLAYBACK_MODE_CHANGE:"playbackmodechange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},qi=Li,Ii="mux-embed",Ni="5.16.1",Ci="2.1",H={},de=function(e){var t=arguments;typeof e=="string"?de.hasOwnProperty(e)?xe.default.setTimeout(function(){t=Array.prototype.splice.call(t,1),de[e].apply(null,t)},0):N.warn("`"+e+"` is an unknown task"):typeof e=="function"?xe.default.setTimeout(function(){e(de)},0):N.warn("`"+e+"` is invalid.")},ji={loaded:F.now(),NAME:Ii,VERSION:Ni,API_VERSION:Ci,PLAYER_TRACKED:!1,monitor:function(e,t){return bi(de,e,t)},destroyMonitor:function(e){var t=re(Be(e),1),a=t[0];a&&a.mux&&typeof a.mux.destroy=="function"?a.mux.destroy():N.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var a=X(e);H[a]?H[a].addHLSJS(t):N.error("A monitor for `"+a+"` has not been initialized.")},addDashJS:function(e,t){var a=X(e);H[a]?H[a].addDashJS(t):N.error("A monitor for `"+a+"` has not been initialized.")},removeHLSJS:function(e){var t=X(e);H[t]?H[t].removeHLSJS():N.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=X(e);H[t]?H[t].removeDashJS():N.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){it()&&t&&t.respectDoNotTrack&&N.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var a=X(e);H[a]=new mi(de,a,t)},emit:function(e,t,a){var r=X(e);H[r]?(H[r].emit(t,a),t==="destroy"&&delete H[r]):N.error("A monitor for `"+r+"` has not been initialized.")},updateData:function(e,t){var a=X(e);H[a]?H[a].emit("hb",t):N.error("A monitor for `"+a+"` has not been initialized.")},setEmitTranslator:function(e,t){var a=X(e);H[a]?H[a].emitTranslator=t:N.error("A monitor for `"+a+"` has not been initialized.")},setStateDataTranslator:function(e,t){var a=X(e);H[a]?H[a].stateDataTranslator=t:N.error("A monitor for `"+a+"` has not been initialized.")},setGetPlayheadTime:function(e,t){var a=X(e);H[a]?H[a].getPlayheadTime=t:N.error("A monitor for `"+a+"` has not been initialized.")},checkDoNotTrack:it,log:N,utils:Pi,events:qi,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(de,ji);typeof xe.default!="undefined"&&typeof xe.default.addEventListener=="function"&&xe.default.addEventListener("pagehide",function(i){i.persisted||(de.WINDOW_UNLOADING=!0)},!1);var ne=de;function Kt(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ve(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},a=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.forEach(function(r){Kt(i,r,t[r])})}return i}function Mi(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);e&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,a)}return t}function Yt(i,e){return e=e!=null?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Mi(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}),i}var Zt=ne.utils,Hi=Zt.findMediaElement,We=Zt.secondsToMs,P=ne.events,ze=ne.log,Ui=function(i){return i===0?"preroll":i===-1?"postroll":"midroll"},Xt=[P.LOADSTART,P.PAUSE,P.PLAY,P.PLAYING,P.SEEKING,P.SEEKED,P.TIME_UPDATE,P.RATECHANGE,P.STALLED,P.WAITING,P.ENDED],Ee=function(i){var e,t;return(t=(e=i.currentSrc)!==null&&e!==void 0?e:i.src)!==null&&t!==void 0?t:void 0},lt=function(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{getSrc:Ee},a=t.getSrc,r=a===void 0?Ee:a,n,o=le(Hi(i),1),u=o[0],s=function(){return u==null?void 0:u.mux};if(!s()){ze.error("Missing mux data instance.");return}if(!(!((n=google)===null||n===void 0)&&n.ima)){ze.error("Missing google.ima SDK. Make sure you include it via a script tag.");return}var d,_=!1,y=!1,c,l,p=!1,h,D=function(){for(var m=arguments.length,A=new Array(m),M=0;M<m;M++)A[M]=arguments[M];var G=le(A,2),J=G[0],j=G[1];if(_){if(c&&u.src===c){if(Xt.includes(J))return}else Xt.includes(J)&&ze.warn("Unexpected event during adbreak:",J);if(J===P.RENDITION_CHANGE){h=j;return}}else if(J===P.PLAY){if(p)return;p=!0}else if(J===P.PAUSE){if(!p)return;p=!1}return A};s().setEmitTranslator(D);var x,E,q=function(){return _&&c&&u.src===c&&E!=null?E:We(u.currentTime)},b=function(){x={player_is_paused:!0,video_source_url:r(u),video_source_duration:We(u.duration),video_source_height:u.videoHeight,video_source_width:u.videoWidth},E=We(u.currentTime)},g=function(){x=void 0,E=void 0},v=function(){return x!=null?x:{}},w=function(m){if(_){var A=y,M=c&&u.src===c?v():{};return Ve(Yt(Ve({},m),{player_is_fullscreen:A}),M)}return m};s().setStateDataTranslator(w),s().setGetPlayheadTime(q);var T=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A,M,G,J,j=(J=(A=m.getAdData)===null||A===void 0?void 0:A.call(m))!==null&&J!==void 0?J:{},z,Ce=(z=(M=m.getAd)===null||M===void 0?void 0:M.call(m))!==null&&z!==void 0?z:{},oa=l?{ad_tag_url:l}:{},Ke,je=(Ke=(G=Ce.getMediaUrl)===null||G===void 0?void 0:G.call(Ce))!==null&&Ke!==void 0?Ke:c,sa=je?{ad_asset_url:je}:{},ua=j!=null&&j.adId?{ad_id:j==null?void 0:j.adId}:{},da=j!=null&&j.creativeId?{ad_creative_id:j==null?void 0:j.creativeId}:{},la=j!=null&&j.universalAdIdValue?{ad_universal_id:j==null?void 0:j.universalAdIdValue}:{},Te,ct;if(je){if(Te=je,typeof Ce.getAdPodInfo=="function"){var Ye=Ce.getAdPodInfo(),ca=Ye.getPodIndex(),_a=Ye.getAdPosition();Te+=":".concat(ca,":").concat(_a);var pa=Ye.getTimeOffset();ct=Ui(pa)}}else Te=l;var va=Te?{ad_request_id:Te,ad_type:ct}:{},ha=_?{player_is_fullscreen:y}:{};return Ve({},oa,sa,ua,da,la,va,ha)};s().triggerAdRequest=function(){s().emit(P.AD_REQUEST,T())};var S=e.requestAds,O=S.bind(e);e.requestAds=function(){for(var m=arguments.length,A=new Array(m),M=0;M<m;M++)A[M]=arguments[M];var G,J,j=le(A,1),z=j[0];return l=z==null?void 0:z.adTagUrl,(G=(J=s()).triggerAdRequest)===null||G===void 0||G.call(J),O==null?void 0:O.apply(void 0,ke(A))};var I,C,L,R,Y=function(m){d=m.getAdsManager(u),I=d.resize,C=I.bind(d),d.resize=function(A,M,G){return y=G===google.ima.ViewMode.FULLSCREEN,C==null?void 0:C(A,M,G)},L=d.init,R=L.bind(d),d.init=function(A,M,G){for(var J=arguments.length,j=new Array(J>3?J-3:0),z=3;z<J;z++)j[z-3]=arguments[z];return y=G===google.ima.ViewMode.FULLSCREEN,R==null?void 0:R.apply(void 0,[A,M,G].concat(ke(j)))},ra(d)},oe=function(m){b(),p&&s().emit(P.PAUSE),_=!0;var A=T(m);c=A.ad_asset_url,s().emit(P.AD_BREAK_START),s().emit(P.AD_PLAY,A)},se=function(m){var A=_;c=void 0,A&&(_=!1,s().emit(P.AD_BREAK_END)),h&&(s().emit(P.RENDITION_CHANGE,h),h=void 0),g()},Q=function(m){var A=T(m);c=A.ad_asset_url,s().emit(P.AD_RESPONSE,A)},te=function(m){var A=T(m);s().emit(P.AD_PLAYING,A)},fe=function(m){var A=T(m);s().emit(P.AD_PLAY,A),s().emit(P.AD_PLAYING,A)},me=function(m){var A=T(m);s().emit(P.AD_PAUSE,A)},ye=function(m){var A=T(m);s().emit(P.AD_FIRST_QUARTILE,A)},ue=function(m){var A=T(m);s().emit(P.AD_MID_POINT,A)},W=function(m){var A=T(m);s().emit(P.AD_THIRD_QUARTILE,A)},Pe=function(m){var A=T(m);s().emit(P.AD_ENDED,A)},Le=function(m){var A=T(m);s().emit(P.AD_ENDED,A)},qe=function(m){_=!1,c=void 0,l=void 0,h=void 0,g()},Ie=function(m){var A=T(m);s().emit(P.AD_RESPONSE,A)},Ne=function(m){var A=m.getError(),M=A.getType();M===google.ima.AdError.Type.AD_LOAD&&s().emit(P.AD_RESPONSE,T()),s().emit(P.AD_ERROR)},ta=function(m){m.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,Y),m.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Ne)},aa=function(m){m.removeEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,Y),m.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Ne)},ra=function(m){m.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,oe),m.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,se),m.addEventListener(google.ima.AdEvent.Type.LOADED,Q),m.addEventListener(google.ima.AdEvent.Type.STARTED,te),m.addEventListener(google.ima.AdEvent.Type.RESUMED,fe),m.addEventListener(google.ima.AdEvent.Type.PAUSED,me),m.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,ye),m.addEventListener(google.ima.AdEvent.Type.MIDPOINT,ue),m.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,W),m.addEventListener(google.ima.AdEvent.Type.COMPLETE,Pe),m.addEventListener(google.ima.AdEvent.Type.SKIPPED,Le),m.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,qe),m.addEventListener(google.ima.AdEvent.Type.AD_METADATA,Ie),m.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Ne)},ia=function(m){m.removeEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,oe),m.removeEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,se),m.removeEventListener(google.ima.AdEvent.Type.LOADED,Q),m.removeEventListener(google.ima.AdEvent.Type.STARTED,te),m.removeEventListener(google.ima.AdEvent.Type.RESUMED,fe),m.removeEventListener(google.ima.AdEvent.Type.PAUSED,me),m.removeEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,ye),m.removeEventListener(google.ima.AdEvent.Type.MIDPOINT,ue),m.removeEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,W),m.removeEventListener(google.ima.AdEvent.Type.COMPLETE,Pe),m.removeEventListener(google.ima.AdEvent.Type.SKIPPED,Le),m.removeEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,qe),m.removeEventListener(google.ima.AdEvent.Type.AD_METADATA,Ie),m.removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,Ne)};s().swapElement=function(m){ze.error("swapElement() is not supported when using google-ima.")};var na=s().destroy;s().destroy=function(){var m=s();aa(e),S&&(e.requestAds=S,S=O=void 0),d&&(ia(d),I&&(d.resize=I,I=C=void 0),L&&(d.init=L,L=R=void 0),d=void 0),m.swapElement=function(){},m.triggerAdRequest=function(){},m.setEmitTranslator(void 0),m.setStateDataTranslator(void 0),m.setGetPlayheadTime(void 0),na()},ta(e)};var $t=ne.utils.findMediaElement,Bi=ne.monitor,Fi=function(i){return i.dashjs!=null},Ji=function(i){return i.hlsjs!=null&&i.Hls!=null},Gi=function(i,e){var t=e.hlsjs,a=e.Hls,r=function(u){var s;return(s=t==null?void 0:t.url)!==null&&s!==void 0?s:Ee(u)},n=function(u){t=u.hlsjs,a=u.Hls},o=function(){t=void 0,a=void 0};return{getSrc:r,addHLSJS:n,removeHLSJS:o}},Qi=function(i,e){var t=e.dashjs,a=function(o){var u;return(u=t==null?void 0:t.getSource())!==null&&u!==void 0?u:Ee(o)},r=function(o){t=o.dashjs},n=function(){t=void 0};return{getSrc:a,addDashJS:r,removeDashJS:n}},Vi=function(i,e){return Ji(e)?Gi(i,e):Fi(e)?Qi(i,e):{getSrc:Ee}},Wi=function(i,e){var t=function(){var o=le($t(i),1),u=o[0];return u==null?void 0:u.mux},a=t(),r=a.addHLSJS,n=a.removeHLSJS;a.addHLSJS=function(o){e.addHLSJS(o),r(o)},a.removeHLSJS=function(){e.removeHLSJS(),n()}},zi=function(i,e){var t=function(){var o=le($t(i),1),u=o[0];return u==null?void 0:u.mux},a=t(),r=a.addDashJS,n=a.removeDashJS;a.addDashJS=function(o){e.addDashJS(o),r(o)},a.removeDashJS=function(){e.removeDashJS(),n()}},Ki=function(i,e){"addHLSJS"in e&&Wi(i,e),"addDashJS"in e&&zi(i,e)},Yi=function(e,t){var a=t.imaAdsLoader;if(Bi(e,t),!!a){var r=Vi(e,t);lt(e,a,{getSrc:r.getSrc}),Ki(e,r)}},Xi={initializeIma:lt,monitor:Yi},ea=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return ne.apply(void 0,ke(e))};Object.assign(ea,ne,Xi);var In=ea;export{zi as attachDashJSMonitorInstanceExtension,Wi as attachHLSJSMonitorInstanceExtension,Ki as attachMonitorInstanceExtensionByOptions,Qi as createDashJSMonitorInstanceExtension,Gi as createHLSJSMonitorInstanceExtension,Vi as createMonitorInstanceExtensionByOptions,In as default,Fi as isDashJSOptions,Ji as isHLSJSOptions};
/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/
